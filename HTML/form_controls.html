<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OA系统 - 表单控件管理</title>
    <link rel="stylesheet" href="../CSS/common.css">
    <link rel="stylesheet" href="../CSS/main.css">
    <style>
        /* 表单控件管理页面专用样式 */
        .controls-container {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .controls-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .controls-title {
            font-size: 20px;
            font-weight: 500;
            color: #333;
        }
        
        .controls-actions {
            display: flex;
            gap: 10px;
        }
        
        .filter-container {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
            padding: 16px 20px;
            margin-bottom: 20px;
        }
        
        .filter-row {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            align-items: flex-end;
        }
        
        .filter-item {
            display: flex;
            flex-direction: column;
            min-width: 200px;
            flex: 1;
        }
        
        .filter-label {
            margin-bottom: 8px;
            font-size: 14px;
            color: #333;
        }
        
        .filter-input {
            padding: 8px 12px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            font-size: 14px;
            outline: none;
        }
        
        .filter-input:focus {
            border-color: #1890ff;
            box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
        }
        
        .filter-buttons {
            display: flex;
            gap: 10px;
            margin-top: 16px;
        }
        
        .controls-table {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .table-title {
            font-size: 16px;
            font-weight: 500;
            color: #333;
        }
        
        .table-actions {
            display: flex;
            gap: 10px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 12px 20px;
            text-align: left;
            border-bottom: 1px solid #f0f0f0;
        }
        
        th {
            background-color: #fafafa;
            font-weight: 500;
            color: #666;
            font-size: 14px;
            white-space: nowrap;
        }
        
        td {
            font-size: 14px;
            color: #333;
        }
        
        tr:hover {
            background-color: #fafafa;
        }
        
        .control-type-tag {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            color: #fff;
        }
        
        .tag-basic {
            background-color: #1890ff;
        }
        
        .tag-advanced {
            background-color: #722ed1;
        }
        
        .tag-custom {
            background-color: #52c41a;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-active {
            background-color: #f6ffed;
            color: #52c41a;
            border: 1px solid #b7eb8f;
        }
        
        .status-inactive {
            background-color: #fff2f0;
            color: #ff4d4f;
            border: 1px solid #ffccc7;
        }
        
        .table-actions-buttons {
            display: flex;
            gap: 8px;
        }
        
        .table-action-btn {
            padding: 4px 12px;
            border: 1px solid #d9d9d9;
            background-color: #fff;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            color: #666;
            transition: all 0.3s;
        }
        
        .table-action-btn:hover {
            color: #1890ff;
            border-color: #1890ff;
        }
        
        .table-action-btn.edit-btn:hover {
            color: #1890ff;
            border-color: #1890ff;
        }
        
        .table-action-btn.delete-btn:hover {
            color: #f5222d;
            border-color: #f5222d;
        }
        
        .table-action-btn.preview-btn:hover {
            color: #fa8c16;
            border-color: #fa8c16;
        }
        
        .pagination {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            padding: 16px 20px;
            border-top: 1px solid #f0f0f0;
        }
        
        .page-info {
            margin-right: 20px;
            font-size: 14px;
            color: #666;
        }
        
        .page-control {
            display: flex;
            gap: 5px;
        }
        
        .page-btn {
            width: 32px;
            height: 32px;
            border: 1px solid #d9d9d9;
            background-color: #fff;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .page-btn:hover {
            color: #1890ff;
            border-color: #1890ff;
        }
        
        .page-btn.active {
            background-color: #1890ff;
            color: #fff;
            border-color: #1890ff;
        }
        
        .page-btn:disabled {
            cursor: not-allowed;
            opacity: 0.5;
        }
        
        /* 模态框样式增强 */
        .modal-content {
            max-width: 800px;
        }
        
        .form-row {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            margin-bottom: 16px;
        }
        
        .form-col {
            flex: 1;
            min-width: 250px;
        }
        
        /* 控件预览 */
        .control-preview {
            margin-top: 20px;
            padding: 20px;
            background-color: #f5f5f5;
            border-radius: 8px;
            border: 1px solid #e8e8e8;
        }
        
        .preview-title {
            font-size: 14px;
            font-weight: 500;
            color: #333;
            margin-bottom: 12px;
        }
        
        /* 控件参数配置 */
        .control-params {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #f0f0f0;
        }
        
        .params-section {
            margin-bottom: 20px;
        }
        
        .section-title {
            font-size: 14px;
            font-weight: 500;
            color: #333;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid #e8e8e8;
        }
        
        .param-group {
            margin-bottom: 12px;
        }
        
        .param-name {
            font-size: 14px;
            color: #333;
            margin-bottom: 6px;
        }
        
        .param-description {
            font-size: 12px;
            color: #999;
            margin-top: 4px;
        }
        
        /* 代码编辑器 */
        .code-editor {
            width: 100%;
            height: 250px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            padding: 12px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
            outline: none;
        }
        
        .code-editor:focus {
            border-color: #1890ff;
            box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
        }
        
        /* 示例代码块 */
        .code-example {
            background-color: #f5f5f5;
            padding: 12px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            overflow-x: auto;
            margin-top: 8px;
            white-space: pre-wrap;
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
            .controls-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .controls-actions {
                width: 100%;
                justify-content: flex-start;
            }
            
            .filter-row {
                flex-direction: column;
            }
            
            .filter-item {
                min-width: 100%;
            }
            
            .filter-buttons {
                justify-content: flex-start;
            }
            
            .table-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .table-actions {
                width: 100%;
                justify-content: flex-end;
            }
            
            .pagination {
                flex-direction: column;
                gap: 10px;
                align-items: center;
            }
            
            .page-info {
                margin-right: 0;
            }
            
            .table-wrapper {
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <!-- 内容区 -->
    <div class="controls-container">
                <!-- 页面头部 -->
                <div class="controls-header">
                    <h1 class="controls-title">表单控件管理</h1>
                    <div class="controls-actions">
                        <button class="btn btn-primary" id="addControlBtn">新增控件</button>
                        <button class="btn btn-default" id="importControlBtn">导入控件</button>
                        <button class="btn btn-default" id="exportControlBtn">导出控件</button>
                    </div>
                </div>

                <!-- 筛选区域 -->
                <div class="filter-container">
                    <div class="filter-row">
                        <div class="filter-item">
                            <label class="filter-label">控件名称</label>
                            <input type="text" class="filter-input" id="controlNameFilter" placeholder="请输入控件名称">
                        </div>
                        <div class="filter-item">
                            <label class="filter-label">控件类型</label>
                            <select class="filter-input" id="controlTypeFilter">
                                <option value="">全部类型</option>
                                <option value="basic">基础控件</option>
                                <option value="advanced">高级控件</option>
                                <option value="custom">自定义控件</option>
                            </select>
                        </div>
                        <div class="filter-item">
                            <label class="filter-label">适用平台</label>
                            <select class="filter-input" id="platformFilter">
                                <option value="">全部平台</option>
                                <option value="web">Web端</option>
                                <option value="mobile">移动端</option>
                                <option value="both">两端通用</option>
                            </select>
                        </div>
                        <div class="filter-item">
                            <label class="filter-label">状态</label>
                            <select class="filter-input" id="statusFilter">
                                <option value="">全部状态</option>
                                <option value="active">启用</option>
                                <option value="inactive">禁用</option>
                            </select>
                        </div>
                    </div>
                    <div class="filter-buttons">
                        <button class="btn btn-primary" id="searchBtn">搜索</button>
                        <button class="btn btn-default" id="resetBtn">重置</button>
                    </div>
                </div>

                <!-- 控件表格 -->
                <div class="controls-table">
                    <div class="table-header">
                        <h2 class="table-title">表单控件列表</h2>
                        <div class="table-actions">
                            <div style="display: flex; align-items: center;">
                                <label style="margin-right: 8px; font-size: 14px; color: #666;">显示：</label>
                                <select class="filter-input" style="width: 100px;">
                                    <option value="10">10条</option>
                                    <option value="20">20条</option>
                                    <option value="50">50条</option>
                                    <option value="100">100条</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th style="width: 40px;">
                                        <input type="checkbox" id="selectAll">
                                    </th>
                                    <th>控件名称</th>
                                    <th>控件编码</th>
                                    <th>控件类型</th>
                                    <th>适用平台</th>
                                    <th>状态</th>
                                    <th>创建时间</th>
                                    <th>更新时间</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr data-control-id="1">
                                    <td>
                                        <input type="checkbox" class="control-checkbox">
                                    </td>
                                    <td>单行文本</td>
                                    <td>TEXT_INPUT</td>
                                    <td>
                                        <span class="control-type-tag tag-basic">基础控件</span>
                                    </td>
                                    <td>两端通用</td>
                                    <td>
                                        <span class="status-badge status-active">启用</span>
                                    </td>
                                    <td>2023-06-15 10:30</td>
                                    <td>2023-06-15 10:30</td>
                                    <td>
                                        <div class="table-actions-buttons">
                                            <button class="table-action-btn edit-btn" title="编辑">编辑</button>
                                            <button class="table-action-btn preview-btn" title="预览">预览</button>
                                            <button class="table-action-btn delete-btn" title="删除">删除</button>
                                        </div>
                                    </td>
                                </tr>
                                <tr data-control-id="2">
                                    <td>
                                        <input type="checkbox" class="control-checkbox">
                                    </td>
                                    <td>多行文本</td>
                                    <td>TEXTAREA</td>
                                    <td>
                                        <span class="control-type-tag tag-basic">基础控件</span>
                                    </td>
                                    <td>两端通用</td>
                                    <td>
                                        <span class="status-badge status-active">启用</span>
                                    </td>
                                    <td>2023-06-15 10:32</td>
                                    <td>2023-06-15 10:32</td>
                                    <td>
                                        <div class="table-actions-buttons">
                                            <button class="table-action-btn edit-btn" title="编辑">编辑</button>
                                            <button class="table-action-btn preview-btn" title="预览">预览</button>
                                            <button class="table-action-btn delete-btn" title="删除">删除</button>
                                        </div>
                                    </td>
                                </tr>
                                <tr data-control-id="3">
                                    <td>
                                        <input type="checkbox" class="control-checkbox">
                                    </td>
                                    <td>数字输入</td>
                                    <td>NUMBER_INPUT</td>
                                    <td>
                                        <span class="control-type-tag tag-basic">基础控件</span>
                                    </td>
                                    <td>两端通用</td>
                                    <td>
                                        <span class="status-badge status-active">启用</span>
                                    </td>
                                    <td>2023-06-15 10:35</td>
                                    <td>2023-06-15 10:35</td>
                                    <td>
                                        <div class="table-actions-buttons">
                                            <button class="table-action-btn edit-btn" title="编辑">编辑</button>
                                            <button class="table-action-btn preview-btn" title="预览">预览</button>
                                            <button class="table-action-btn delete-btn" title="删除">删除</button>
                                        </div>
                                    </td>
                                </tr>
                                <tr data-control-id="4">
                                    <td>
                                        <input type="checkbox" class="control-checkbox">
                                    </td>
                                    <td>日期选择</td>
                                    <td>DATE_PICKER</td>
                                    <td>
                                        <span class="control-type-tag tag-advanced">高级控件</span>
                                    </td>
                                    <td>两端通用</td>
                                    <td>
                                        <span class="status-badge status-active">启用</span>
                                    </td>
                                    <td>2023-06-15 10:38</td>
                                    <td>2023-06-15 10:38</td>
                                    <td>
                                        <div class="table-actions-buttons">
                                            <button class="table-action-btn edit-btn" title="编辑">编辑</button>
                                            <button class="table-action-btn preview-btn" title="预览">预览</button>
                                            <button class="table-action-btn delete-btn" title="删除">删除</button>
                                        </div>
                                    </td>
                                </tr>
                                <tr data-control-id="5">
                                    <td>
                                        <input type="checkbox" class="control-checkbox">
                                    </td>
                                    <td>下拉选择</td>
                                    <td>SELECT</td>
                                    <td>
                                        <span class="control-type-tag tag-basic">基础控件</span>
                                    </td>
                                    <td>两端通用</td>
                                    <td>
                                        <span class="status-badge status-active">启用</span>
                                    </td>
                                    <td>2023-06-15 10:40</td>
                                    <td>2023-06-15 10:40</td>
                                    <td>
                                        <div class="table-actions-buttons">
                                            <button class="table-action-btn edit-btn" title="编辑">编辑</button>
                                            <button class="table-action-btn preview-btn" title="预览">预览</button>
                                            <button class="table-action-btn delete-btn" title="删除">删除</button>
                                        </div>
                                    </td>
                                </tr>
                                <tr data-control-id="6">
                                    <td>
                                        <input type="checkbox" class="control-checkbox">
                                    </td>
                                    <td>单选框组</td>
                                    <td>RADIO_GROUP</td>
                                    <td>
                                        <span class="control-type-tag tag-basic">基础控件</span>
                                    </td>
                                    <td>两端通用</td>
                                    <td>
                                        <span class="status-badge status-active">启用</span>
                                    </td>
                                    <td>2023-06-15 10:42</td>
                                    <td>2023-06-15 10:42</td>
                                    <td>
                                        <div class="table-actions-buttons">
                                            <button class="table-action-btn edit-btn" title="编辑">编辑</button>
                                            <button class="table-action-btn preview-btn" title="预览">预览</button>
                                            <button class="table-action-btn delete-btn" title="删除">删除</button>
                                        </div>
                                    </td>
                                </tr>
                                <tr data-control-id="7">
                                    <td>
                                        <input type="checkbox" class="control-checkbox">
                                    </td>
                                    <td>复选框组</td>
                                    <td>CHECKBOX_GROUP</td>
                                    <td>
                                        <span class="control-type-tag tag-basic">基础控件</span>
                                    </td>
                                    <td>两端通用</td>
                                    <td>
                                        <span class="status-badge status-active">启用</span>
                                    </td>
                                    <td>2023-06-16 09:15</td>
                                    <td>2023-06-16 09:15</td>
                                    <td>
                                        <div class="table-actions-buttons">
                                            <button class="table-action-btn edit-btn" title="编辑">编辑</button>
                                            <button class="table-action-btn preview-btn" title="预览">预览</button>
                                            <button class="table-action-btn delete-btn" title="删除">删除</button>
                                        </div>
                                    </td>
                                </tr>
                                <tr data-control-id="8">
                                    <td>
                                        <input type="checkbox" class="control-checkbox">
                                    </td>
                                    <td>文件上传</td>
                                    <td>FILE_UPLOAD</td>
                                    <td>
                                        <span class="control-type-tag tag-advanced">高级控件</span>
                                    </td>
                                    <td>Web端</td>
                                    <td>
                                        <span class="status-badge status-active">启用</span>
                                    </td>
                                    <td>2023-06-16 14:30</td>
                                    <td>2023-06-16 14:30</td>
                                    <td>
                                        <div class="table-actions-buttons">
                                            <button class="table-action-btn edit-btn" title="编辑">编辑</button>
                                            <button class="table-action-btn preview-btn" title="预览">预览</button>
                                            <button class="table-action-btn delete-btn" title="删除">删除</button>
                                        </div>
                                    </td>
                                </tr>
                                <tr data-control-id="9">
                                    <td>
                                        <input type="checkbox" class="control-checkbox">
                                    </td>
                                    <td>图片上传</td>
                                    <td>IMAGE_UPLOAD</td>
                                    <td>
                                        <span class="control-type-tag tag-advanced">高级控件</span>
                                    </td>
                                    <td>两端通用</td>
                                    <td>
                                        <span class="status-badge status-active">启用</span>
                                    </td>
                                    <td>2023-06-17 11:20</td>
                                    <td>2023-06-17 11:20</td>
                                    <td>
                                        <div class="table-actions-buttons">
                                            <button class="table-action-btn edit-btn" title="编辑">编辑</button>
                                            <button class="table-action-btn preview-btn" title="预览">预览</button>
                                            <button class="table-action-btn delete-btn" title="删除">删除</button>
                                        </div>
                                    </td>
                                </tr>
                                <tr data-control-id="10">
                                    <td>
                                        <input type="checkbox" class="control-checkbox">
                                    </td>
                                    <td>富文本编辑器</td>
                                    <td>RICH_TEXT_EDITOR</td>
                                    <td>
                                        <span class="control-type-tag tag-advanced">高级控件</span>
                                    </td>
                                    <td>Web端</td>
                                    <td>
                                        <span class="status-badge status-inactive">禁用</span>
                                    </td>
                                    <td>2023-06-18 16:45</td>
                                    <td>2023-06-18 16:45</td>
                                    <td>
                                        <div class="table-actions-buttons">
                                            <button class="table-action-btn edit-btn" title="编辑">编辑</button>
                                            <button class="table-action-btn preview-btn" title="预览">预览</button>
                                            <button class="table-action-btn delete-btn" title="删除">删除</button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="pagination">
                        <div class="page-info">显示 1-10 条，共 24 条</div>
                        <div class="page-control">
                            <button class="page-btn" disabled>上一页</button>
                            <button class="page-btn active">1</button>
                            <button class="page-btn">2</button>
                            <button class="page-btn">3</button>
                            <button class="page-btn">下一页</button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- 新增/编辑控件模态框 -->
    <div class="modal" id="controlModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">新增表单控件</h3>
                <button class="modal-close" onclick="closeControlModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="controlForm">
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label class="form-label">控件名称 <span style="color: #f5222d;">*</span></label>
                                <input type="text" class="form-control" id="controlName" name="controlName" required placeholder="请输入控件名称">
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="form-group">
                                <label class="form-label">控件编码 <span style="color: #f5222d;">*</span></label>
                                <input type="text" class="form-control" id="controlCode" name="controlCode" required placeholder="请输入控件编码（英文大写、数字、下划线）">
                                <p style="font-size: 12px; color: #999; margin-top: 4px;">控件编码用于系统内部使用，建议使用英文大写、数字和下划线</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label class="form-label">控件类型 <span style="color: #f5222d;">*</span></label>
                                <select class="form-control" id="controlType" name="controlType" required>
                                    <option value="">请选择控件类型</option>
                                    <option value="basic">基础控件</option>
                                    <option value="advanced">高级控件</option>
                                    <option value="custom">自定义控件</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="form-group">
                                <label class="form-label">适用平台 <span style="color: #f5222d;">*</span></label>
                                <select class="form-control" id="platform" name="platform" required>
                                    <option value="">请选择适用平台</option>
                                    <option value="web">Web端</option>
                                    <option value="mobile">移动端</option>
                                    <option value="both">两端通用</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label class="form-label">图标</label>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <input type="text" class="form-control" id="controlIcon" name="controlIcon" placeholder="请输入图标类名或URL">
                                    <div id="iconPreview" style="width: 32px; height: 32px; display: flex; align-items: center; justify-content: center;"></div>
                                </div>
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="form-group">
                                <label class="form-label">状态</label>
                                <select class="form-control" id="controlStatus" name="controlStatus">
                                    <option value="active">启用</option>
                                    <option value="inactive">禁用</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">控件描述</label>
                        <textarea class="form-control" id="controlDescription" name="controlDescription" rows="3" placeholder="请输入控件描述"></textarea>
                    </div>
                    
                    <!-- 控件实现代码 -->
                    <div class="control-params">
                        <div class="params-section">
                            <div class="section-title">控件实现代码</div>
                            <div class="form-group">
                                <label class="form-label">HTML模板 <span style="color: #f5222d;">*</span></label>
                                <textarea class="code-editor" id="htmlTemplate" name="htmlTemplate" required placeholder="请输入HTML模板代码"></textarea>
                                <div class="code-example">
&lt;div class="form-group"&gt;
  &lt;label class="form-label"&gt;{{label}}&lt;/label&gt;
  &lt;input type="text" 
         class="form-control" 
         placeholder="{{placeholder}}"
         value="{{value}}"
         {{#if required}}required{{/if}}
         {{#if disabled}}disabled{{/if}}
         {{#each attributes}}{{key}}="{{value}}" {{/each}}
  &gt;
&lt;/div&gt;
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">JavaScript逻辑</label>
                                <textarea class="code-editor" id="javascriptLogic" name="javascriptLogic" placeholder="请输入JavaScript逻辑代码"></textarea>
                                <div class="code-example">
// 控件初始化逻辑
function initControl(container, options) {
  const { value, onChange } = options;
  const input = container.querySelector('input');
  
  if (value) {
    input.value = value;
  }
  
  // 监听输入事件
  input.addEventListener('input', function(e) {
    if (onChange) {
      onChange(e.target.value);
    }
  });
  
  // 返回控件API
  return {
    getValue: function() {
      return input.value;
    },
    setValue: function(value) {
      input.value = value;
    },
    disable: function() {
      input.disabled = true;
    },
    enable: function() {
      input.disabled = false;
    }
  };
}
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">CSS样式</label>
                                <textarea class="code-editor" id="cssStyle" name="cssStyle" placeholder="请输入CSS样式代码"></textarea>
                                <div class="code-example">
.form-group {
  margin-bottom: 16px;
}

.form-label {
  display: block;
  margin-bottom: 8px;
  font-size: 14px;
  color: #333;
}

.form-control {
  width: 100%;
  padding: 8px 12px;
  border: 1px solid #d9d9d9;
  border-radius: 4px;
  font-size: 14px;
  outline: none;
  transition: all 0.3s;
}

.form-control:focus {
  border-color: #1890ff;
  box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
}
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 控件参数配置 -->
                    <div class="control-params">
                        <div class="params-section">
                            <div class="section-title">控件参数配置</div>
                            <div class="param-group">
                                <div class="param-name">基础参数</div>
                                <div class="param-description">控件的基本配置参数，包括标签、占位符、默认值等</div>
                                <textarea class="code-editor" id="basicParams" name="basicParams" placeholder="请输入基础参数配置（JSON格式）">{
  "label": {
    "type": "string",
    "required": true,
    "default": "",
    "description": "字段标签"
  },
  "placeholder": {
    "type": "string",
    "required": false,
    "default": "",
    "description": "占位文本"
  },
  "defaultValue": {
    "type": "string",
    "required": false,
    "default": "",
    "description": "默认值"
  },
  "required": {
    "type": "boolean",
    "required": false,
    "default": false,
    "description": "是否必填"
  },
  "disabled": {
    "type": "boolean",
    "required": false,
    "default": false,
    "description": "是否禁用"
  }
}</textarea>
                            </div>
                            
                            <div class="param-group">
                                <div class="param-name">高级参数</div>
                                <div class="param-description">控件的高级配置参数，根据控件类型不同而变化</div>
                                <textarea class="code-editor" id="advancedParams" name="advancedParams" placeholder="请输入高级参数配置（JSON格式）">{}</textarea>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 控件预览 -->
                    <div class="control-preview">
                        <div class="preview-title">控件预览</div>
                        <div id="controlPreviewContainer" style="background-color: #fff; padding: 20px; border-radius: 4px;">
                            <!-- 控件预览将在这里显示 -->
                            <div style="text-align: center; color: #999; padding: 40px 0;">
                                请填写控件代码后预览效果
                            </div>
                        </div>
                        <button type="button" class="btn btn-default" id="previewBtn" style="margin-top: 12px;">预览控件</button>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-default" onclick="closeControlModal()">取消</button>
                <button class="btn btn-primary" id="saveControlBtn">保存</button>
            </div>
        </div>
    </div>

    <script src="../JS/common.js"></script>
    <script src="../JS/main.js"></script>
    <script>
        // 表单控件管理页面专用脚本
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化变量
            const controlModal = document.getElementById('controlModal');
            const addControlBtn = document.getElementById('addControlBtn');
            const saveControlBtn = document.getElementById('saveControlBtn');
            const modalTitle = document.getElementById('modalTitle');
            const controlIconInput = document.getElementById('controlIcon');
            const iconPreview = document.getElementById('iconPreview');
            const previewBtn = document.getElementById('previewBtn');
            const controlPreviewContainer = document.getElementById('controlPreviewContainer');
            const selectAllCheckbox = document.getElementById('selectAll');
            const controlCheckboxes = document.querySelectorAll('.control-checkbox');
            const searchBtn = document.getElementById('searchBtn');
            const resetBtn = document.getElementById('resetBtn');
            const importControlBtn = document.getElementById('importControlBtn');
            const exportControlBtn = document.getElementById('exportControlBtn');
            
            // 当前编辑的控件ID
            let currentControlId = null;
            
            // 初始化事件监听
            initEventListeners();
            
            // 初始化表格操作按钮
            initTableActions();
            
            // 初始化图标输入事件
            controlIconInput.addEventListener('input', function() {
                updateIconPreview();
            });
            
            // 初始化预览按钮事件
            previewBtn.addEventListener('click', function() {
                previewControl();
            });
            
            // 初始化全选/取消全选事件
            selectAllCheckbox.addEventListener('change', function() {
                const isChecked = this.checked;
                controlCheckboxes.forEach(checkbox => {
                    checkbox.checked = isChecked;
                });
            });
            
            // 初始化单选框变化事件
            controlCheckboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    updateSelectAllStatus();
                });
            });
        });
        
        /**
         * 初始化事件监听
         */
        function initEventListeners() {
            // 新增控件按钮事件
            document.getElementById('addControlBtn').addEventListener('click', function() {
                openAddControlModal();
            });
            
            // 保存控件按钮事件
            document.getElementById('saveControlBtn').addEventListener('click', function() {
                saveControl();
            });
            
            // 搜索按钮事件
            document.getElementById('searchBtn').addEventListener('click', function() {
                searchControls();
            });
            
            // 重置按钮事件
            document.getElementById('resetBtn').addEventListener('click', function() {
                resetFilters();
            });
            
            // 导入控件按钮事件
            document.getElementById('importControlBtn').addEventListener('click', function() {
                importControls();
            });
            
            // 导出控件按钮事件
            document.getElementById('exportControlBtn').addEventListener('click', function() {
                exportControls();
            });
            
            // 模态框点击外部关闭
            document.getElementById('controlModal').addEventListener('click', function(event) {
                if (event.target === this) {
                    closeControlModal();
                }
            });
        }
        
        /**
         * 初始化表格操作按钮
         */
        function initTableActions() {
            // 编辑按钮事件
            const editButtons = document.querySelectorAll('.table-action-btn.edit-btn');
            editButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const controlId = this.closest('tr').dataset.controlId;
                    openEditControlModal(controlId);
                });
            });
            
            // 预览按钮事件
            const previewButtons = document.querySelectorAll('.table-action-btn.preview-btn');
            previewButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const controlId = this.closest('tr').dataset.controlId;
                    previewControlById(controlId);
                });
            });
            
            // 删除按钮事件
            const deleteButtons = document.querySelectorAll('.table-action-btn.delete-btn');
            deleteButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const controlId = this.closest('tr').dataset.controlId;
                    deleteControl(controlId);
                });
            });
        }
        
        /**
         * 更新图标预览
         */
        function updateIconPreview() {
            const iconValue = document.getElementById('controlIcon').value.trim();
            const iconPreview = document.getElementById('iconPreview');
            
            iconPreview.innerHTML = '';
            
            if (!iconValue) {
                return;
            }
            
            // 判断是URL还是图标类名
            if (iconValue.match(/^https?:\/\//)) {
                // 是URL，创建img标签
                const img = document.createElement('img');
                img.src = iconValue;
                img.style.maxWidth = '32px';
                img.style.maxHeight = '32px';
                iconPreview.appendChild(img);
            } else if (iconValue.match(/^<svg/i)) {
                // 是SVG代码
                iconPreview.innerHTML = iconValue;
            } else {
                // 是图标类名或其他
                iconPreview.textContent = iconValue;
                iconPreview.style.fontSize = '24px';
            }
        }
        
        /**
         * 预览控件
         */
        function previewControl() {
            const htmlTemplate = document.getElementById('htmlTemplate').value;
            const javascriptLogic = document.getElementById('javascriptLogic').value;
            const cssStyle = document.getElementById('cssStyle').value;
            const controlPreviewContainer = document.getElementById('controlPreviewContainer');
            
            if (!htmlTemplate) {
                showMessage('请先输入HTML模板代码', 'warning');
                return;
            }
            
            try {
                // 清空预览容器
                controlPreviewContainer.innerHTML = '';
                
                // 创建样式标签
                if (cssStyle) {
                    const styleElement = document.createElement('style');
                    styleElement.textContent = cssStyle;
                    controlPreviewContainer.appendChild(styleElement);
                }
                
                // 渲染HTML模板
                // 这里简化处理，实际项目中可能需要更复杂的模板引擎
                let renderedHtml = htmlTemplate;
                
                // 替换一些简单的模板变量
                renderedHtml = renderedHtml.replace(/{{label}}/g, '预览标签');
                renderedHtml = renderedHtml.replace(/{{placeholder}}/g, '请输入...');
                renderedHtml = renderedHtml.replace(/{{value}}/g, '预览值');
                renderedHtml = renderedHtml.replace(/{{#if required}}required{{\/if}}/g, '');
                renderedHtml = renderedHtml.replace(/{{#if disabled}}disabled{{\/if}}/g, '');
                renderedHtml = renderedHtml.replace(/{{#each attributes}}{{key}}="{{value}}" {{\/each}}/g, '');
                
                // 设置渲染后的HTML
                controlPreviewContainer.innerHTML += renderedHtml;
                
                // 执行JavaScript逻辑（如果有）
                if (javascriptLogic) {
                    try {
                        // 创建一个函数来执行逻辑
                        const initFunc = new Function('container', 'options', javascriptLogic);
                        
                        // 查找控件容器
                        let container = controlPreviewContainer;
                        const formGroup = controlPreviewContainer.querySelector('.form-group');
                        if (formGroup) {
                            container = formGroup;
                        }
                        
                        // 调用初始化函数
                        initFunc(container, {
                            value: '预览值',
                            onChange: function(value) {
                                console.log('控件值变化:', value);
                            }
                        });
                    } catch (jsError) {
                        console.error('JavaScript执行错误:', jsError);
                        showMessage('JavaScript执行错误: ' + jsError.message, 'error');
                    }
                }
                
                // 显示成功消息
                showMessage('控件预览成功', 'success');
            } catch (error) {
                console.error('预览失败:', error);
                showMessage('预览失败: ' + error.message, 'error');
                controlPreviewContainer.innerHTML = `
                    <div style="text-align: center; color: #f5222d; padding: 40px 0;">
                        预览失败：${error.message}
                    </div>
                `;
            }
        }
        
        /**
         * 打开新增控件模态框
         */
        function openAddControlModal() {
            // 重置表单
            const controlForm = document.getElementById('controlForm');
            controlForm.reset();
            
            // 重置预览
            document.getElementById('controlPreviewContainer').innerHTML = `
                <div style="text-align: center; color: #999; padding: 40px 0;">
                    请填写控件代码后预览效果
                </div>
            `;
            
            // 重置图标预览
            document.getElementById('iconPreview').innerHTML = '';
            
            // 设置模态框标题
            document.getElementById('modalTitle').textContent = '新增表单控件';
            
            // 重置当前编辑的控件ID
            currentControlId = null;
            
            // 显示模态框
            document.getElementById('controlModal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }
        
        /**
         * 打开编辑控件模态框
         * @param {string} controlId - 控件ID
         */
        function openEditControlModal(controlId) {
            // 重置表单
            const controlForm = document.getElementById('controlForm');
            controlForm.reset();
            
            // 设置当前编辑的控件ID
            currentControlId = controlId;
            
            // 设置模态框标题
            document.getElementById('modalTitle').textContent = '编辑表单控件';
            
            // 模拟加载控件数据
            loadControlData(controlId);
            
            // 显示模态框
            document.getElementById('controlModal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }
        
        /**
         * 关闭控件模态框
         */
        function closeControlModal() {
            document.getElementById('controlModal').style.display = 'none';
            document.body.style.overflow = '';
        }
        
        /**
         * 加载控件数据
         * @param {string} controlId - 控件ID
         */
        function loadControlData(controlId) {
            // 模拟根据ID获取控件数据
            // 实际项目中应该从服务器获取数据
            let controlData = {
                name: '',
                code: '',
                type: '',
                platform: '',
                icon: '',
                status: 'active',
                description: '',
                htmlTemplate: '',
                javascriptLogic: '',
                cssStyle: '',
                basicParams: {},
                advancedParams: {}
            };
            
            // 根据控件ID模拟不同的控件数据
            switch(controlId) {
                case '1':
                    controlData = {
                        name: '单行文本',
                        code: 'TEXT_INPUT',
                        type: 'basic',
                        platform: 'both',
                        icon: '\uF24E',
                        status: 'active',
                        description: '基础的文本输入控件，用于输入单行文本内容',
                        htmlTemplate: `<div class="form-group">\n  <label class="form-label">{{label}}</label>\n  <input type="text" \n         class="form-control" \n         placeholder="{{placeholder}}"\n         value="{{value}}"\n         {{#if required}}required{{/if}}\n         {{#if disabled}}disabled{{/if}}\n         {{#each attributes}}{{key}}="{{value}}" {{/each}}\n  >\n</div>`,
                        javascriptLogic: `// 控件初始化逻辑\nfunction initControl(container, options) {\n  const { value, onChange } = options;\n  const input = container.querySelector('input');\n  \n  if (value) {\n    input.value = value;\n  }\n  \n  // 监听输入事件\n  input.addEventListener('input', function(e) {\n    if (onChange) {\n      onChange(e.target.value);\n    }\n  });\n  \n  // 返回控件API\n  return {\n    getValue: function() {\n      return input.value;\n    },\n    setValue: function(value) {\n      input.value = value;\n    },\n    disable: function() {\n      input.disabled = true;\n    },\n    enable: function() {\n      input.disabled = false;\n    }\n  };\n}`,
                        cssStyle: `.form-group {\n  margin-bottom: 16px;\n}\n\n.form-label {\n  display: block;\n  margin-bottom: 8px;\n  font-size: 14px;\n  color: #333;\n}\n\n.form-control {\n  width: 100%;\n  padding: 8px 12px;\n  border: 1px solid #d9d9d9;\n  border-radius: 4px;\n  font-size: 14px;\n  outline: none;\n  transition: all 0.3s;\n}\n\n.form-control:focus {\n  border-color: #1890ff;\n  box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);\n}`,
                        basicParams: {
                          "label": {
                            "type": "string",
                            "required": true,
                            "default": "",
                            "description": "字段标签"
                          },
                          "placeholder": {
                            "type": "string",
                            "required": false,
                            "default": "",
                            "description": "占位文本"
                          },
                          "defaultValue": {
                            "type": "string",
                            "required": false,
                            "default": "",
                            "description": "默认值"
                          },
                          "required": {
                            "type": "boolean",
                            "required": false,
                            "default": false,
                            "description": "是否必填"
                          },
                          "disabled": {
                            "type": "boolean",
                            "required": false,
                            "default": false,
                            "description": "是否禁用"
                          }
                        },
                        advancedParams: {}
                    };
                    break;
                case '2':
                    controlData = {
                        name: '多行文本',
                        code: 'TEXTAREA',
                        type: 'basic',
                        platform: 'both',
                        icon: '\uF24D',
                        status: 'active',
                        description: '用于输入多行文本内容的控件',
                        htmlTemplate: `<div class="form-group">\n  <label class="form-label">{{label}}</label>\n  <textarea class="form-control" \n            placeholder="{{placeholder}}"\n            rows="{{rows}}"\n            {{#if required}}required{{/if}}\n            {{#if disabled}}disabled{{/if}}\n            {{#each attributes}}{{key}}="{{value}}" {{/each}}>\n{{value}}\n</textarea>\n</div>`,
                        javascriptLogic: `// 控件初始化逻辑\nfunction initControl(container, options) {\n  const { value, onChange } = options;\n  const textarea = container.querySelector('textarea');\n  \n  if (value) {\n    textarea.value = value;\n  }\n  \n  // 监听输入事件\n  textarea.addEventListener('input', function(e) {\n    if (onChange) {\n      onChange(e.target.value);\n    }\n  });\n  \n  // 返回控件API\n  return {\n    getValue: function() {\n      return textarea.value;\n    },\n    setValue: function(value) {\n      textarea.value = value;\n    },\n    disable: function() {\n      textarea.disabled = true;\n    },\n    enable: function() {\n      textarea.disabled = false;\n    }\n  };\n}`,
                        cssStyle: `.form-group {\n  margin-bottom: 16px;\n}\n\n.form-label {\n  display: block;\n  margin-bottom: 8px;\n  font-size: 14px;\n  color: #333;\n}\n\n.form-control {\n  width: 100%;\n  padding: 8px 12px;\n  border: 1px solid #d9d9d9;\n  border-radius: 4px;\n  font-size: 14px;\n  outline: none;\n  transition: all 0.3s;\n  resize: vertical;\n}\n\n.form-control:focus {\n  border-color: #1890ff;\n  box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);\n}`,
                        basicParams: {
                          "label": {
                            "type": "string",
                            "required": true,
                            "default": "",
                            "description": "字段标签"
                          },
                          "placeholder": {
                            "type": "string",
                            "required": false,
                            "default": "",
                            "description": "占位文本"
                          },
                          "defaultValue": {
                            "type": "string",
                            "required": false,
                            "default": "",
                            "description": "默认值"
                          },
                          "required": {
                            "type": "boolean",
                            "required": false,
                            "default": false,
                            "description": "是否必填"
                          },
                          "disabled": {
                            "type": "boolean",
                            "required": false,
                            "default": false,
                            "description": "是否禁用"
                          }
                        },
                        advancedParams: {
                          "rows": {
                            "type": "number",
                            "required": false,
                            "default": 3,
                            "description": "文本框行数"
                          },
                          "maxLength": {
                            "type": "number",
                            "required": false,
                            "default": 0,
                            "description": "最大输入长度，0表示不限制"
                          }
                        }
                    };
                    break;
                // 其他控件ID的数据...
            }
            
            // 填充表单数据
            document.getElementById('controlName').value = controlData.name;
            document.getElementById('controlCode').value = controlData.code;
            document.getElementById('controlType').value = controlData.type;
            document.getElementById('platform').value = controlData.platform;
            document.getElementById('controlIcon').value = controlData.icon;
            document.getElementById('controlStatus').value = controlData.status;
            document.getElementById('controlDescription').value = controlData.description;
            document.getElementById('htmlTemplate').value = controlData.htmlTemplate;
            document.getElementById('javascriptLogic').value = controlData.javascriptLogic;
            document.getElementById('cssStyle').value = controlData.cssStyle;
            document.getElementById('basicParams').value = JSON.stringify(controlData.basicParams, null, 2);
            document.getElementById('advancedParams').value = JSON.stringify(controlData.advancedParams, null, 2);
            
            // 更新图标预览
            updateIconPreview();
        }
        
        /**
         * 保存控件
         */
        function saveControl() {
            const controlForm = document.getElementById('controlForm');
            
            // 表单验证
            if (!controlForm.checkValidity()) {
                controlForm.reportValidity();
                return;
            }
            
            // 收集表单数据
            const controlData = {
                id: currentControlId,
                name: document.getElementById('controlName').value,
                code: document.getElementById('controlCode').value,
                type: document.getElementById('controlType').value,
                platform: document.getElementById('platform').value,
                icon: document.getElementById('controlIcon').value,
                status: document.getElementById('controlStatus').value,
                description: document.getElementById('controlDescription').value,
                htmlTemplate: document.getElementById('htmlTemplate').value,
                javascriptLogic: document.getElementById('javascriptLogic').value,
                cssStyle: document.getElementById('cssStyle').value,
                basicParams: {},
                advancedParams: {}
            };
            
            // 解析参数配置
            try {
                controlData.basicParams = JSON.parse(document.getElementById('basicParams').value || '{}');
            } catch (e) {
                showMessage('基础参数配置格式错误：' + e.message, 'error');
                return;
            }
            
            try {
                controlData.advancedParams = JSON.parse(document.getElementById('advancedParams').value || '{}');
            } catch (e) {
                showMessage('高级参数配置格式错误：' + e.message, 'error');
                return;
            }
            
            // 模拟提交数据到服务器
            console.log('保存控件数据:', controlData);
            
            // 显示成功消息
            showMessage(currentControlId ? '控件更新成功' : '控件创建成功', 'success');
            
            // 关闭模态框
            closeControlModal();
            
            // 刷新表格数据
            refreshTable();
        }
        
        /**
         * 根据ID预览控件
         * @param {string} controlId - 控件ID
         */
        function previewControlById(controlId) {
            // 模拟预览控件
            // 实际项目中应该从服务器获取数据并显示预览
            showMessage('控件预览功能将在实际实现时提供', 'info');
        }
        
        /**
         * 删除控件
         * @param {string} controlId - 控件ID
         */
        function deleteControl(controlId) {
            // 显示确认对话框
            if (confirm('确定要删除这个表单控件吗？删除后将无法恢复。')) {
                // 模拟删除操作
                // 实际项目中应该调用API删除服务器上的数据
                console.log('删除控件:', controlId);
                
                // 显示成功消息
                showMessage('控件删除成功', 'success');
                
                // 刷新表格数据
                refreshTable();
            }
        }
        
        /**
         * 搜索控件
         */
        function searchControls() {
            // 获取搜索条件
            const controlName = document.getElementById('controlNameFilter').value.trim();
            const controlType = document.getElementById('controlTypeFilter').value;
            const platform = document.getElementById('platformFilter').value;
            const status = document.getElementById('statusFilter').value;
            
            // 构建搜索条件对象
            const searchParams = {
                controlName,
                controlType,
                platform,
                status
            };
            
            // 模拟搜索操作
            console.log('搜索控件:', searchParams);
            
            // 刷新表格数据
            refreshTable(searchParams);
        }
        
        /**
         * 重置筛选条件
         */
        function resetFilters() {
            document.getElementById('controlNameFilter').value = '';
            document.getElementById('controlTypeFilter').value = '';
            document.getElementById('platformFilter').value = '';
            document.getElementById('statusFilter').value = '';
        }
        
        /**
         * 导入控件
         */
        function importControls() {
            // 创建隐藏的文件输入元素
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = '.json,.txt';
            fileInput.style.display = 'none';
            
            // 添加文件选择事件
            fileInput.addEventListener('change', function(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            // 解析导入的JSON数据
                            const controlsData = JSON.parse(e.target.result);
                            
                            // 模拟导入操作
                            console.log('导入控件数据:', controlsData);
                            
                            // 显示成功消息
                            showMessage('控件导入成功', 'success');
                            
                            // 刷新表格数据
                            refreshTable();
                        } catch (error) {
                            showMessage('导入失败：文件格式不正确', 'error');
                        }
                    };
                    reader.readAsText(file);
                }
            });
            
            // 添加到文档并触发点击
            document.body.appendChild(fileInput);
            fileInput.click();
            
            // 清理
            setTimeout(() => {
                document.body.removeChild(fileInput);
            }, 0);
        }
        
        /**
         * 导出控件
         */
        function exportControls() {
            // 获取选中的控件
            const selectedControlIds = getSelectedControlIds();
            
            // 如果没有选中控件，导出所有控件
            const exportParams = selectedControlIds.length > 0 ? {
                controlIds: selectedControlIds
            } : {};
            
            // 模拟导出操作
            console.log('导出控件:', exportParams);
            
            // 模拟生成导出数据
            const exportData = {
                exportTime: new Date().toISOString(),
                version: '1.0',
                controls: getCurrentTableData()
            };
            
            // 创建下载链接
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileName = 'form_controls_' + new Date().toISOString().replace(/[:.]/g, '-') + '.json';
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileName);
            linkElement.style.display = 'none';
            document.body.appendChild(linkElement);
            
            // 触发下载
            linkElement.click();
            
            // 清理
            document.body.removeChild(linkElement);
            
            // 显示成功消息
            showMessage('控件导出成功', 'success');
        }
        
        /**
         * 获取选中的控件ID列表
         * @returns {Array} 选中的控件ID列表
         */
        function getSelectedControlIds() {
            const selectedIds = [];
            const checkedBoxes = document.querySelectorAll('.control-checkbox:checked');
            
            checkedBoxes.forEach(checkbox => {
                const controlId = checkbox.closest('tr').dataset.controlId;
                if (controlId) {
                    selectedIds.push(controlId);
                }
            });
            
            return selectedIds;
        }
        
        /**
         * 更新全选复选框状态
         */
        function updateSelectAllStatus() {
            const selectAllCheckbox = document.getElementById('selectAll');
            const controlCheckboxes = document.querySelectorAll('.control-checkbox');
            const checkedBoxes = document.querySelectorAll('.control-checkbox:checked');
            
            selectAllCheckbox.checked = controlCheckboxes.length > 0 && controlCheckboxes.length === checkedBoxes.length;
        }
        
        /**
         * 刷新表格数据
         * @param {Object} searchParams - 搜索参数
         */
        function refreshTable(searchParams = {}) {
            // 模拟表格数据刷新
            // 实际项目中应该根据搜索参数从服务器获取数据
            console.log('刷新表格数据，搜索参数:', searchParams);
            
            // 这里可以添加加载动画
            // 然后重新渲染表格数据
        }
        
        /**
         * 获取当前表格数据（用于导出）
         * @returns {Array} 表格数据数组
         */
        function getCurrentTableData() {
            const tableData = [];
            const tableRows = document.querySelectorAll('tbody tr');
            
            tableRows.forEach(row => {
                const cells = row.querySelectorAll('td');
                if (cells.length >= 8) {
                    const controlId = row.dataset.controlId;
                    const controlName = cells[1].textContent.trim();
                    const controlCode = cells[2].textContent.trim();
                    const controlType = cells[3].querySelector('.control-type-tag')?.textContent.trim() || '';
                    const platform = cells[4].textContent.trim();
                    const status = cells[5].querySelector('.status-badge')?.textContent.trim() || '';
                    const createTime = cells[6].textContent.trim();
                    const updateTime = cells[7].textContent.trim();
                    
                    tableData.push({
                        id: controlId,
                        name: controlName,
                        code: controlCode,
                        type: controlType,
                        platform: platform,
                        status: status,
                        createTime: createTime,
                        updateTime: updateTime
                    });
                }
            });
            
            return tableData;
        }
        
        /**
         * 显示消息提示
         * @param {string} message - 消息内容
         * @param {string} type - 消息类型：success, error, warning, info
         */
        function showMessage(message, type = 'info') {
            // 使用common.js中的showMessage函数
            if (window.showMessage) {
                window.showMessage(message, type);
            } else {
                // 降级处理
                alert(message);
            }
        }
    </script>
</body>
</html>