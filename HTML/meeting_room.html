<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>会议室管理 - OA系统</title>
    <link rel="stylesheet" href="../CSS/common.css">
    <link rel="stylesheet" href="../CSS/main.css">
    <script src="../JS/common.js"></script>
    <style>
        /* 主容器样式 */
        .meeting-room-container {
            padding: 20px;
        }
        
        /* 头部样式 */
        .meeting-room-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .meeting-room-header h2 {
            margin: 0;
            color: #333;
            font-size: 20px;
        }
        
        .header-actions {
            display: flex;
            gap: 12px;
        }
        
        /* 按钮基础样式 */
        .btn-primary {
            background-color: #409EFF;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .btn-primary:hover {
            background-color: #66b1ff;
        }
        
        .btn-secondary {
            padding: 8px 16px;
            border: 1px solid #dcdfe6;
            background-color: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .btn-secondary:hover {
            border-color: #409EFF;
            color: #409EFF;
        }
        
        /* 链接按钮样式美化 */
        .btn-secondary {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        /* 确保链接按钮的文字和按钮按钮保持一致的样式 */
        .btn-secondary:link, .btn-secondary:visited {
            color: #606266;
            text-decoration: none;
        }
        
        .btn-secondary:hover {
            color: #409EFF;
            text-decoration: none;
        }
        
        /* 为头部操作区域的链接按钮添加轻微的悬浮效果 */
        .header-actions .btn-secondary {
            position: relative;
            overflow: hidden;
        }
        
        .header-actions .btn-secondary::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background-color: #409EFF;
            transition: width 0.3s ease;
        }
        
        .header-actions .btn-secondary:hover::after {
            width: 100%;
        }
        
        .btn-danger {
            background-color: #f56c6c;
            color: white;
            border: none;
        }
        
        .btn-danger:hover {
            background-color: #f78989;
            border-color: #f78989;
        }
        
        /* 搜索筛选区域样式 */
        .search-filter {
            background-color: white;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            padding: 16px 24px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 24px;
        }
        
        .filter-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .filter-group label {
            font-size: 14px;
            color: #606266;
            white-space: nowrap;
        }
        
        .filter-group select {
            padding: 6px 12px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .filter-group input[type="text"] {
            padding: 6px 12px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            font-size: 14px;
            width: 200px;
        }
        
        .filter-actions {
            margin-left: auto;
            display: flex;
            gap: 12px;
        }
        
        /* 会议室卡片网格 */
        .room-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        /* 会议室卡片样式 */
        .room-card {
            background-color: white;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            padding: 20px;
            border-left: 4px solid #409EFF;
            transition: all 0.3s ease;
        }
        
        .room-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }
        
        .room-card.occupied {
            border-left-color: #f56c6c;
        }
        
        .room-card.available {
            border-left-color: #67c23a;
        }
        
        .room-card.maintenance {
            border-left-color: #e6a23c;
        }
        
        /* 会议室卡片头部 */
        .room-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }
        
        .room-title {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .room-name {
            font-size: 18px;
            font-weight: 500;
            color: #333;
            margin: 0;
        }
        
        /* 状态标签样式 */
        .room-status {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .room-status.occupied {
            background-color: #fef0f0;
            color: #f56c6c;
        }
        
        .room-status.available {
            background-color: #f0f9ff;
            color: #67c23a;
        }
        
        .room-status.maintenance {
            background-color: #fdf6ec;
            color: #e6a23c;
        }
        
        /* 会议室信息 */
        .room-info {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 16px;
        }
        
        .info-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: #606266;
        }
        
        .info-label {
            color: #909399;
            min-width: 60px;
        }
        
        /* 按钮组样式 */
        .button-group {
            display: flex;
            gap: 8px;
            width: 100%;
        }
        
        .primary-actions {
            margin-bottom: 12px;
        }
        
        .process-actions {
            border-top: 1px solid #f0f0f0;
            padding-top: 12px;
        }
        
        /* 会议室操作按钮 */
        .room-action-btn {
            padding: 4px 12px;
            border: 1px solid #dcdfe6;
            background-color: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .room-action-btn:hover {
            border-color: #409EFF;
            color: #409EFF;
        }
        
        .room-action-btn.primary {
            background-color: #409EFF;
            color: white;
            border-color: #409EFF;
        }
        
        .room-action-btn.primary:hover {
            background-color: #66b1ff;
            border-color: #66b1ff;
        }
        
        /* 流程操作按钮 */
        .process-action-btn {
            padding: 4px 12px;
            border: 1px solid #dcdfe6;
            background-color: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            min-width: 70px;
        }
        
        .process-action-btn:hover {
            border-color: #409EFF;
            color: #409EFF;
        }
        
        /* 会议室日程 */
        .room-schedule {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid #f0f0f0;
        }
        
        .schedule-card-title {
            font-size: 14px;
            font-weight: 500;
            color: #333;
            margin-bottom: 8px;
        }
        
        .schedule-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 6px 12px;
            background-color: #f5f7fa;
            border-radius: 4px;
            font-size: 12px;
            margin-bottom: 4px;
        }
        
        .schedule-time {
            color: #606266;
        }
        
        .schedule-item-title {
            color: #909399;
            font-size: 12px;
        }
        
        .no-schedule {
            text-align: center;
            padding: 16px;
            color: #909399;
            font-size: 14px;
        }
        
        .pagination {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 8px;
            margin-top: 20px;
            padding: 16px;
            background-color: white;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        .pagination-info {
            font-size: 14px;
            color: #606266;
            margin-right: auto;
        }
        
        .pagination-btn {
            padding: 6px 12px;
            border: 1px solid #dcdfe6;
            background-color: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .pagination-btn:hover:not(:disabled) {
            border-color: #409EFF;
            color: #409EFF;
        }
        
        .pagination-btn:disabled {
            cursor: not-allowed;
            opacity: 0.5;
        }
        
        .pagination-btn.active {
            background-color: #409EFF;
            color: white;
            border-color: #409EFF;
        }
        
        .pagination-select {
            padding: 6px 12px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            font-size: 14px;
        }
        
        /* 模态框通用样式 */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            visibility: hidden;
            opacity: 0;
            transition: visibility 0s, opacity 0.3s ease;
        }
        
        .modal-overlay.show {
            visibility: visible;
            opacity: 1;
        }
        
        .modal {
            background-color: white;
            border-radius: 4px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        
        .modal-header {
            padding: 16px 24px;
            border-bottom: 1px solid #e4e7ed;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            margin: 0;
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 20px;
            color: #999;
            cursor: pointer;
            width: 24px;
            height: 24px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .modal-close:hover {
            color: #666;
        }
        
        .modal-body {
            padding: 24px;
            flex: 1;
            overflow-y: auto;
        }
        
        .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid #e4e7ed;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }
        
        /* 会议室详情模态框样式 */
        .room-detail {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .detail-section {
            background-color: #f5f7fa;
            border-radius: 4px;
            padding: 16px;
        }
        
        .detail-section h3 {
            margin: 0 0 12px 0;
            font-size: 16px;
            color: #333;
        }
        
        .detail-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        
        .detail-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .detail-label {
            color: #909399;
            min-width: 80px;
        }
        
        .detail-value {
            color: #606266;
            flex: 1;
        }
        
        .equipment-list {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .equipment-tag {
            background-color: #f0f9ff;
            color: #409EFF;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
        }
        
        /* 日程详情模态框样式 */
        .schedule-calendar {
            background-color: #f5f7fa;
            border-radius: 4px;
            padding: 16px;
            margin-bottom: 16px;
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .calendar-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }
        
        .calendar-nav {
            display: flex;
            gap: 8px;
        }
        
        .calendar-nav-btn {
            padding: 4px 12px;
            border: 1px solid #dcdfe6;
            background-color: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .calendar-nav-btn:hover {
            border-color: #409EFF;
            color: #409EFF;
        }
        
        .schedule-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .schedule-day-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-top: 16px;
            margin-bottom: 8px;
        }
        
        .schedule-day-title:first-child {
            margin-top: 0;
        }
        
        .schedule-detail-item {
            display: flex;
            padding: 12px;
            background-color: #f5f7fa;
            border-radius: 4px;
            border-left: 4px solid #409EFF;
        }
        
        .schedule-time-info {
            min-width: 100px;
            margin-right: 16px;
            color: #606266;
            font-size: 14px;
        }
        
        .schedule-content {
            flex: 1;
        }
        
        .schedule-content h4 {
            margin: 0 0 8px 0;
            font-size: 16px;
            color: #333;
        }
        
        .schedule-content p {
            margin: 0 0 8px 0;
            color: #606266;
            font-size: 14px;
        }
        
        .schedule-meta {
            display: flex;
            gap: 16px;
            font-size: 12px;
            color: #909399;
        }
        
        .schedule-empty {
            text-align: center;
            padding: 24px;
            color: #909399;
            font-size: 14px;
        }
        
        /* 流程操作表单样式 */
        .process-form-content {
            display: none;
        }
        
        .process-form-content.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 16px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            color: #606266;
            font-weight: 500;
        }
        
        .form-control {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        .form-control:focus {
            border-color: #409EFF;
            outline: none;
            box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.2);
        }
        
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
        }
        
        .checkbox-group label {
            display: flex;
            align-items: center;
            margin-bottom: 0;
            font-weight: normal;
        }
        
        .checkbox-group input[type="checkbox"] {
            margin-right: 6px;
        }
        
        textarea.form-control {
            resize: vertical;
            min-height: 60px;
        }
        
        /* 签到功能样式 */
        .attendance-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .attendance-header label {
            margin-bottom: 0;
        }
        
        .attendees-container {
            margin-bottom: 12px;
        }
        
        .attendee-item {
            display: flex;
            gap: 8px;
            align-items: center;
            margin-bottom: 8px;
            padding: 12px;
            background-color: #f5f7fa;
            border-radius: 4px;
        }
        
        .attendee-item .form-control {
            flex: 1;
        }
        
        .attendee-item .form-control.small {
            flex: 1;
            padding: 6px 8px;
            font-size: 12px;
        }
        
        .attendee-name {
            flex: 2 !important;
        }
        
        .attendee-status {
            flex: 1.5 !important;
        }
        
        .attendee-time {
            flex: 1 !important;
        }
        
        .remove-attendee-btn {
            white-space: nowrap;
            padding: 4px 8px;
            font-size: 12px;
        }
        
        .btn-secondary.small {
            padding: 4px 12px;
            font-size: 12px;
        }
        
        .attendance-summary {
            padding: 10px 12px;
            background-color: #ecf5ff;
            border-radius: 4px;
            font-size: 13px;
            color: #409eff;
        }
        
        #present-count {
            color: #67c23a;
            font-weight: 500;
        }
        
        #absent-count {
            color: #f56c6c;
            font-weight: 500;
        }
        
        #pending-count {
            color: #e6a23c;
            font-weight: 500;
        }
        
        /* 表单区块样式 */
        .form-section {
            margin-bottom: 24px;
            padding: 16px;
            background-color: #fafafa;
            border-radius: 4px;
        }
        
        .form-section h4 {
            margin: 0 0 16px 0;
            padding-bottom: 8px;
            border-bottom: 1px solid #e0e0e0;
            font-size: 14px;
            color: #303133;
            font-weight: 500;
        }
        
        /* 任务管理样式 */
        .task-management {
            margin-bottom: 12px;
        }
        
        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .task-header h5 {
            margin: 0;
            font-size: 13px;
            color: #606266;
            font-weight: 500;
        }
        
        .tasks-container {
            margin-bottom: 12px;
        }
        
        .task-item {
            display: flex;
            gap: 8px;
            align-items: center;
            margin-bottom: 8px;
            padding: 12px;
            background-color: white;
            border-radius: 4px;
            border: 1px solid #e0e0e0;
        }
        
        .task-item .form-control {
            flex: 1;
        }
        
        .task-item .form-control.small {
            flex: 1;
            padding: 6px 8px;
            font-size: 12px;
        }
        
        .task-description {
            flex: 2.5 !important;
        }
        
        .task-assignee {
            flex: 1.5 !important;
        }
        
        .task-deadline {
            flex: 1.2 !important;
        }
        
        .remove-task-btn {
            white-space: nowrap;
            padding: 4px 8px;
            font-size: 12px;
        }
        
        /* 确保按钮样式统一 */
        .btn-secondary.small {
            padding: 4px 12px;
            font-size: 12px;
        }
        
        .remove-attendee-btn, .remove-task-btn {
            white-space: nowrap;
            padding: 4px 8px;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="meeting-room-container">
        <div class="meeting-room-header">
            <h2>会议室管理</h2>
            <div class="header-actions">
                <button class="btn-secondary">刷新</button>
                <a href="meeting_my.html" class="btn-secondary" style="text-decoration: none;">我的会议</a>
                <a href="meeting_statistics.html" class="btn-secondary" style="text-decoration: none;">会议统计（作废）</a>
                <a href="meeting_minutes.html" class="btn-secondary" style="text-decoration: none;">会议纪要（作废）</a>
                <button class="btn-primary">预订会议室</button>
            </div>
    
    <!-- 会议室详情模态框 -->
    <div id="room-detail-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">会议室详情</h3>
                <button id="close-modal" class="modal-close">×</button>
            </div>
            <div class="modal-body">
                <div class="room-detail">
                    <!-- 基本信息 -->
                    <div class="detail-section">
                        <h3>基本信息</h3>
                        <div class="detail-info">
                            <div class="detail-item">
                                <span class="detail-label">会议室名称：</span>
                                <span id="detail-room-name" class="detail-value">--</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">当前状态：</span>
                                <span id="detail-room-status" class="detail-value">--</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">容纳人数：</span>
                                <span id="detail-room-capacity" class="detail-value">--</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">会议室面积：</span>
                                <span id="detail-room-area" class="detail-value">--</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">所在位置：</span>
                                <span id="detail-room-location" class="detail-value">--</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">创建时间：</span>
                                <span id="detail-created-time" class="detail-value">2023-01-15</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 设备信息 -->
                    <div class="detail-section">
                        <h3>设备配置</h3>
                        <div id="detail-equipment-list" class="equipment-list">
                            <!-- 设备标签会通过JavaScript动态添加 -->
                        </div>
                    </div>
                    
                    <!-- 详细描述 -->
                    <div class="detail-section">
                        <h3>会议室描述</h3>
                        <p id="detail-room-description" class="detail-value" style="line-height: 1.6;">--</p>
                    </div>
                    
                    <!-- 使用须知 -->
                    <div class="detail-section">
                        <h3>使用须知</h3>
                        <ul style="color: #606266; line-height: 1.6; padding-left: 20px;">
                            <li>请提前10分钟到达会议室，准备会议所需设备</li>
                            <li>会议结束后，请关闭所有设备电源，整理好会议用品</li>
                            <li>请勿在会议室内吸烟、饮食</li>
                            <li>请保持会议室清洁整洁</li>
                            <li>如有设备故障，请联系IT部门维修</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="modal-close-btn" class="btn-secondary">关闭</button>
                <button id="modal-book-btn" class="btn-primary">立即预订</button>
            </div>
        </div>
    </div>
    
    <!-- 日程详情模态框 -->
    <div id="room-schedule-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3 id="schedule-modal-title" class="modal-title">会议室日程</h3>
                <button id="close-schedule-modal" class="modal-close">×</button>
            </div>
            <div class="modal-body">
                <!-- 日历导航 -->
                <div class="schedule-calendar">
                    <div class="calendar-header">
                        <div class="calendar-title" id="current-date-range">2023年6月1日 - 2023年6月7日</div>
                        <div class="calendar-nav">
                            <button id="prev-week" class="calendar-nav-btn">上一周</button>
                            <button id="today-btn" class="calendar-nav-btn">今天</button>
                            <button id="next-week" class="calendar-nav-btn">下一周</button>
                        </div>
                    </div>
                </div>
                
                <!-- 日程列表 -->
                <div id="schedule-content" class="schedule-list">
                    <!-- 日程内容将通过JavaScript动态添加 -->
                </div>
            </div>
            <div class="modal-footer">
                <button id="schedule-modal-close-btn" class="btn-secondary">关闭</button>
                <button id="schedule-modal-book-btn" class="btn-primary">预订此会议室</button>
            </div>
        </div>
    </div>
    
    <!-- 流程操作模态框 -->
    <div id="process-action-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3 id="process-modal-title" class="modal-title">流程操作</h3>
                <button id="close-process-modal" class="modal-close">×</button>
            </div>
            <div class="modal-body">
                <form id="process-action-form">
                    <input type="hidden" id="process-room-name">
                    <input type="hidden" id="process-type">
                    
                    <!-- 会前准备表单内容 -->
                    <div id="pre-meeting-form" class="process-form-content">
                        <div class="form-group">
                            <label for="meeting-title">会议标题</label>
                            <input type="text" id="meeting-title" class="form-control" placeholder="请输入会议标题">
                        </div>
                        <div class="form-group">
                            <label for="meeting-attendees">参会人数</label>
                            <input type="number" id="meeting-attendees" class="form-control" min="1" placeholder="请输入参会人数">
                        </div>
                        <div class="form-group">
                            <label for="required-equipment">所需设备</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="equipment" value="projector">投影仪</label>
                                <label><input type="checkbox" name="equipment" value="whiteboard">白板</label>
                                <label><input type="checkbox" name="equipment" value="video">视频会议</label>
                                <label><input type="checkbox" name="equipment" value="microphone">麦克风</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="pre-meeting-notes">会前准备事项</label>
                            <textarea id="pre-meeting-notes" class="form-control" rows="3" placeholder="请输入需要准备的事项"></textarea>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="equipment-check" name="checklist">设备检查正常
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="clean-check" name="checklist">会议室清洁
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="supplies-check" name="checklist">会议用品准备
                            </label>
                        </div>
                    </div>
                    
                    <!-- 会中确认表单内容 -->
                    <div id="in-meeting-form" class="process-form-content">
                        <div class="form-group">
                            <label for="current-agenda">当前议程</label>
                            <textarea id="current-agenda" class="form-control" rows="2" placeholder="请输入当前讨论的议程"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="meeting-status">会议状态</label>
                            <select id="meeting-status" class="form-control">
                                <option value="on-time">准时进行</option>
                                <option value="delay">有所延迟</option>
                                <option value="ahead">提前进行</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="equipment-status">设备状态</label>
                            <select id="equipment-status" class="form-control">
                                <option value="normal">正常</option>
                                <option value="minor">轻微问题</option>
                                <option value="major">严重问题</option>
                            </select>
                        </div>
                        
                        <!-- 签到功能 -->
                        <div class="form-group">
                            <div class="attendance-header">
                                <label>参会人员签到</label>
                                <button id="add-attendee-btn" type="button" class="btn-secondary small">添加人员</button>
                            </div>
                            <div id="attendees-container" class="attendees-container">
                                <!-- 参会人员列表 -->
                                <div class="attendee-item">
                                    <input type="text" class="attendee-name form-control small" placeholder="输入姓名">
                                    <select class="attendee-status form-control small">
                                        <option value="pending">待签到</option>
                                        <option value="present">已签到</option>
                                        <option value="absent">缺席</option>
                                    </select>
                                    <input type="time" class="attendee-time form-control small">
                                    <button type="button" class="remove-attendee-btn btn-danger small">移除</button>
                                </div>
                            </div>
                            <div class="attendance-summary">
                                <span>签到统计：</span>
                                <span id="present-count">0</span>人已签到，
                                <span id="absent-count">0</span>人缺席，
                                <span id="pending-count">1</span>人待签到
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="in-meeting-notes">会议记录</label>
                            <textarea id="in-meeting-notes" class="form-control" rows="3" placeholder="请输入会议重点记录"></textarea>
                        </div>
                    </div>
                    
                    <!-- 会后清理表单内容 -->
                    <div id="post-meeting-form" class="process-form-content">
                        <!-- 会议基本信息 -->
                        <div class="form-section">
                            <h4>会议基本信息</h4>
                            <div class="form-group">
                                <label for="meeting-duration">实际会议时长</label>
                                <input type="text" id="meeting-duration" class="form-control" placeholder="如：2小时30分钟">
                            </div>
                            <div class="form-group">
                                <label for="actual-attendees">实际参会人数</label>
                                <input type="number" id="actual-attendees" class="form-control" min="1" placeholder="请输入实际参会人数">
                            </div>
                            <div class="form-group">
                                <label for="meeting-quality">会议质量评价</label>
                                <select id="meeting-quality" class="form-control">
                                    <option value="excellent">优秀</option>
                                    <option value="good">良好</option>
                                    <option value="normal">一般</option>
                                    <option value="poor">较差</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- 会议成果 -->
                        <div class="form-section">
                            <h4>会议成果</h4>
                            <div class="form-group">
                                <label for="meeting-summary">会议总结</label>
                                <textarea id="meeting-summary" class="form-control" rows="2" placeholder="请输入会议简要总结"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="meeting-decisions">会议决议</label>
                                <textarea id="meeting-decisions" class="form-control" rows="3" placeholder="请输入会议达成的决议事项"></textarea>
                            </div>
                        </div>
                        
                        <!-- 任务分配 -->
                        <div class="form-section">
                            <h4>后续任务</h4>
                            <div class="task-management">
                                <div class="task-header">
                                    <h5>任务分配</h5>
                                    <button id="add-task-btn" type="button" class="btn-secondary small">添加任务</button>
                                </div>
                                <div id="tasks-container" class="tasks-container">
                                    <div class="task-item">
                                        <input type="text" class="task-description form-control small" placeholder="任务描述">
                                        <input type="text" class="task-assignee form-control small" placeholder="负责人">
                                        <input type="date" class="task-deadline form-control small">
                                        <button type="button" class="remove-task-btn btn-danger small">移除</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 设备与环境检查 -->
                        <div class="form-section">
                            <h4>设备与环境检查</h4>
                            <div class="checkbox-group">
                                <label><input type="checkbox" id="equipment-off" name="post-checklist">设备已关闭</label>
                                <label><input type="checkbox" id="room-cleaned" name="post-checklist">会议室已清理</label>
                                <label><input type="checkbox" id="supplies-returned" name="post-checklist">会议用品已归还</label>
                                <label><input type="checkbox" id="trash-disposed" name="post-checklist">垃圾已清理</label>
                            </div>
                            
                            <div class="form-group">
                                <label for="equipment-issues">设备问题反馈</label>
                                <textarea id="equipment-issues" class="form-control" rows="2" placeholder="如有设备故障或异常，请在此说明"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="room-feedback">会议室使用反馈</label>
                                <select id="room-feedback" class="form-control">
                                    <option value="satisfied">满意</option>
                                    <option value="neutral">一般</option>
                                    <option value="dissatisfied">不满意</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- 其他信息 -->
                        <div class="form-section">
                            <h4>其他信息</h4>
                            <div class="form-group">
                                <label for="improvement-suggestions">改进建议</label>
                                <textarea id="improvement-suggestions" class="form-control" rows="2" placeholder="请输入对会议组织或会议室设施的改进建议"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="post-meeting-notes">备注</label>
                                <textarea id="post-meeting-notes" class="form-control" rows="2" placeholder="请输入其他需要说明的事项"></textarea>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button id="process-modal-cancel-btn" class="btn-secondary">取消</button>
                <button id="process-modal-submit-btn" class="btn-primary">确认提交</button>
            </div>
        </div>
    </div>
        </div>
        
        <div class="search-filter">
            <div class="filter-group">
                <label for="room-status">状态：</label>
                <select id="room-status">
                    <option value="">全部</option>
                    <option value="available">空闲</option>
                    <option value="occupied">占用</option>
                    <option value="maintenance">维护中</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label for="room-capacity">容纳人数：</label>
                <select id="room-capacity">
                    <option value="">全部</option>
                    <option value="small">5人以下</option>
                    <option value="medium">5-15人</option>
                    <option value="large">15-30人</option>
                    <option value="xlarge">30人以上</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label for="room-equipment">设备：</label>
                <select id="room-equipment">
                    <option value="">全部</option>
                    <option value="projector">投影仪</option>
                    <option value="video">视频会议</option>
                    <option value="whiteboard">白板</option>
                    <option value="microphone">麦克风</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label for="room-search">搜索：</label>
                <input type="text" id="room-search" placeholder="请输入会议室名称">
            </div>
            
            <div class="filter-actions">
                <button class="btn-secondary">重置</button>
                <button class="btn-primary">搜索</button>
            </div>
        </div>
        
        <div class="room-grid">
            <!-- 会议室卡片 1 -->
            <div class="room-card available">
                <div class="room-header">
                    <div class="room-title">
                        <h3 class="room-name">会议室A</h3>
                    </div>
                    <span class="room-status available">空闲</span>
                </div>
                
                <div class="room-info">
                    <div class="info-item">
                        <span class="info-label">容纳：</span>
                        <span>12人</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">位置：</span>
                        <span>3楼东区</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">设备：</span>
                        <span>投影仪、白板、视频会议</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">面积：</span>
                        <span>30㎡</span>
                    </div>
                </div>
                
                <!-- 主要操作按钮组 -->
                <div class="button-group primary-actions">
                    <button class="room-action-btn primary">立即预订</button>
                    <button class="room-action-btn">查看详情</button>
                    <button class="room-action-btn">查看日程</button>
                </div>
                
                <!-- 流程按钮组 -->
                <div class="button-group process-actions">
                    <button class="process-action-btn" data-room="会议室A" data-type="pre-meeting">会前</button>
                    <button class="process-action-btn" data-room="会议室A" data-type="in-meeting">会中</button>
                    <button class="process-action-btn" data-room="会议室A" data-type="post-meeting">会后</button>
                </div>
                
                <div class="room-schedule">
                    <div class="schedule-card-title">今日日程</div>
                    <div class="no-schedule">
                        暂无日程安排
                    </div>
                </div>
            </div>
            
            <!-- 会议室卡片 2 -->
            <div class="room-card occupied">
                <div class="room-header">
                    <div class="room-title">
                        <h3 class="room-name">会议室B</h3>
                    </div>
                    <span class="room-status occupied">占用中</span>
                </div>
                
                <div class="room-info">
                    <div class="info-item">
                        <span class="info-label">容纳：</span>
                        <span>20人</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">位置：</span>
                        <span>3楼中区</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">设备：</span>
                        <span>投影仪、白板、麦克风、视频会议</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">面积：</span>
                        <span>45㎡</span>
                    </div>
                </div>
                
                <!-- 主要操作按钮组 -->
                <div class="button-group primary-actions">
                    <button class="room-action-btn primary" disabled>已被占用</button>
                    <button class="room-action-btn">查看详情</button>
                    <button class="room-action-btn">查看日程</button>
                </div>
                
                <!-- 流程按钮组 -->
                <div class="button-group process-actions">
                    <button class="process-action-btn" data-room="会议室B" data-type="pre-meeting">会前</button>
                    <button class="process-action-btn" data-room="会议室B" data-type="in-meeting">会中</button>
                    <button class="process-action-btn" data-room="会议室B" data-type="post-meeting">会后</button>
                </div>
                
                <div class="room-schedule">
                    <div class="schedule-card-title">今日日程</div>
                    <div class="schedule-item">
                        <span class="schedule-time">10:00 - 11:30</span>
                        <span class="schedule-item-title">周例会</span>
                    </div>
                    <div class="schedule-item">
                        <span class="schedule-time">14:00 - 15:30</span>
                        <span class="schedule-item-title">客户需求沟通会</span>
                    </div>
                </div>
            </div>
            
            <!-- 会议室卡片 3 -->
            <div class="room-card available">
                <div class="room-header">
                    <div class="room-title">
                        <h3 class="room-name">会议室C</h3>
                    </div>
                    <span class="room-status available">空闲</span>
                </div>
                
                <div class="room-info">
                    <div class="info-item">
                        <span class="info-label">容纳：</span>
                        <span>8人</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">位置：</span>
                        <span>3楼西区</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">设备：</span>
                        <span>投影仪、白板</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">面积：</span>
                        <span>20㎡</span>
                    </div>
                </div>
                
                <!-- 主要操作按钮组 -->
                <div class="button-group primary-actions">
                    <button class="room-action-btn primary">立即预订</button>
                    <button class="room-action-btn">查看详情</button>
                    <button class="room-action-btn">查看日程</button>
                </div>
                
                <!-- 流程按钮组 -->
                <div class="button-group process-actions">
                    <button class="process-action-btn" data-room="会议室C" data-type="pre-meeting">会前</button>
                    <button class="process-action-btn" data-room="会议室C" data-type="in-meeting">会中</button>
                    <button class="process-action-btn" data-room="会议室C" data-type="post-meeting">会后</button>
                </div>
                
                <div class="room-schedule">
                    <div class="schedule-card-title">今日日程</div>
                    <div class="no-schedule">
                        暂无日程安排
                    </div>
                </div>
            </div>
            
            <!-- 会议室卡片 4 -->
            <div class="room-card maintenance">
                <div class="room-header">
                    <div class="room-title">
                        <h3 class="room-name">会议室D</h3>
                    </div>
                    <span class="room-status maintenance">维护中</span>
                </div>
                
                <div class="room-info">
                    <div class="info-item">
                        <span class="info-label">容纳：</span>
                        <span>30人</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">位置：</span>
                        <span>4楼东区</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">设备：</span>
                        <span>投影仪、白板、麦克风、视频会议、音响</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">面积：</span>
                        <span>60㎡</span>
                    </div>
                </div>
                
                <!-- 主要操作按钮组 -->
                <div class="button-group primary-actions">
                    <button class="room-action-btn primary" disabled>维护中</button>
                    <button class="room-action-btn">查看详情</button>
                    <button class="room-action-btn">查看日程</button>
                </div>
                
                <!-- 流程按钮组 -->
                <!-- <div class="button-group process-actions">
                    <button class="process-action-btn" data-room="会议室D" data-type="pre-meeting">会前</button>
                    <button class="process-action-btn" data-room="会议室D" data-type="in-meeting">会中</button>
                    <button class="process-action-btn" data-room="会议室D" data-type="post-meeting">会后</button>
                </div> -->
                
                <div class="room-schedule">
                    <div class="schedule-card-title">今日日程</div>
                    <div class="no-schedule">
                        因设备维护，今日暂停使用
                    </div>
                </div>
            </div>
            
            <!-- 会议室卡片 5 -->
            <div class="room-card available">
                <div class="room-header">
                    <div class="room-title">
                        <h3 class="room-name">会议室E</h3>
                    </div>
                    <span class="room-status available">空闲</span>
                </div>
                
                <div class="room-info">
                    <div class="info-item">
                        <span class="info-label">容纳：</span>
                        <span>5人</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">位置：</span>
                        <span>4楼中区</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">设备：</span>
                        <span>白板</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">面积：</span>
                        <span>15㎡</span>
                    </div>
                </div>
                
                <!-- 主要操作按钮组 -->
                <div class="button-group primary-actions">
                    <button class="room-action-btn primary">立即预订</button>
                    <button class="room-action-btn">查看详情</button>
                    <button class="room-action-btn">查看日程</button>
                </div>
                
                <!-- 流程按钮组 -->
                <div class="button-group process-actions">
                    <button class="process-action-btn" data-room="会议室E" data-type="pre-meeting">会前</button>
                    <button class="process-action-btn" data-room="会议室E" data-type="in-meeting">会中</button>
                    <button class="process-action-btn" data-room="会议室E" data-type="post-meeting">会后</button>
                </div>
                
                <div class="room-schedule">
                    <div class="schedule-card-title">今日日程</div>
                    <div class="schedule-item">
                        <span class="schedule-time">16:00 - 17:00</span>
                        <span class="schedule-item-title">技术讨论</span>
                    </div>
                </div>
            </div>
            
            <!-- 会议室卡片 6 -->
            <div class="room-card occupied">
                <div class="room-header">
                    <div class="room-title">
                        <h3 class="room-name">会议室F</h3>
                    </div>
                    <span class="room-status occupied">占用中</span>
                </div>
                
                <div class="room-info">
                    <div class="info-item">
                        <span class="info-label">容纳：</span>
                        <span>15人</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">位置：</span>
                        <span>4楼西区</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">设备：</span>
                        <span>投影仪、白板、麦克风</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">面积：</span>
                        <span>35㎡</span>
                    </div>
                </div>
                
                <!-- 主要操作按钮组 -->
                <div class="button-group primary-actions">
                    <button class="room-action-btn primary" disabled>已被占用</button>
                    <button class="room-action-btn">查看详情</button>
                    <button class="room-action-btn">查看日程</button>
                </div>
                
                <!-- 流程按钮组 -->
                <div class="button-group process-actions">
                    <button class="process-action-btn" data-room="会议室F" data-type="pre-meeting">会前</button>
                    <button class="process-action-btn" data-room="会议室F" data-type="in-meeting">会中</button>
                    <button class="process-action-btn" data-room="会议室F" data-type="post-meeting">会后</button>
                </div>
                
                <div class="room-schedule">
                    <div class="schedule-card-title">今日日程</div>
                    <div class="schedule-item">
                        <span class="schedule-time">09:30 - 11:00</span>
                        <span class="schedule-item-title">产品评审会</span>
                    </div>
                    <div class="schedule-item">
                        <span class="schedule-time">13:30 - 15:30</span>
                        <span class="schedule-item-title">项目启动会</span>
                    </div>
                    <div class="schedule-item">
                        <span class="schedule-time">16:00 - 17:30</span>
                        <span class="schedule-item-title">技术评审</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="pagination">
            <div class="pagination-info">
                共 12 个会议室，当前显示第 1-6 个
            </div>
            <button class="pagination-btn" disabled>
                &lt;
            </button>
            <button class="pagination-btn active">1</button>
            <button class="pagination-btn">2</button>
            <button class="pagination-btn">
                &gt;
            </button>
            <div style="display: flex; align-items: center; gap: 8px; font-size: 14px; color: #606266; white-space: nowrap;">
                每页显示：
                <select class="pagination-select">
                    <option value="6">6</option>
                    <option value="12">12</option>
                    <option value="24">24</option>
                </select>
            </div>
        </div>
    </div>

    <script src="../JS/common.js"></script>
    <script>
        // 消息提示函数
        function showMessage(message, type) {
            // 创建消息元素
            const messageElement = document.createElement('div');
            messageElement.className = `message-notification message-${type}`;
            messageElement.textContent = message;
            
            // 设置样式
            Object.assign(messageElement.style, {
                position: 'fixed',
                top: '20px',
                right: '20px',
                padding: '12px 24px',
                borderRadius: '4px',
                color: 'white',
                fontSize: '14px',
                zIndex: '2000',
                boxShadow: '0 4px 12px rgba(0, 0, 0, 0.15)',
                transition: 'all 0.3s ease',
                transform: 'translateX(100%)',
                opacity: '0'
            });
            
            // 根据类型设置背景色
            if (type === 'success') {
                messageElement.style.backgroundColor = '#67c23a';
            } else if (type === 'error') {
                messageElement.style.backgroundColor = '#f56c6c';
            } else if (type === 'warning') {
                messageElement.style.backgroundColor = '#e6a23c';
            } else if (type === 'info') {
                messageElement.style.backgroundColor = '#409EFF';
            }
            
            // 添加到页面
            document.body.appendChild(messageElement);
            
            // 显示消息
            setTimeout(() => {
                messageElement.style.transform = 'translateX(0)';
                messageElement.style.opacity = '1';
            }, 10);
            
            // 3秒后自动消失
            setTimeout(() => {
                messageElement.style.transform = 'translateX(100%)';
                messageElement.style.opacity = '0';
                
                // 动画结束后移除元素
                setTimeout(() => {
                    document.body.removeChild(messageElement);
                }, 300);
            }, 3000);
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            // 刷新按钮点击事件
            const refreshButton = document.querySelector('.header-actions .btn-secondary');
            if (refreshButton) {
                refreshButton.addEventListener('click', function() {
                    showMessage('刷新成功', 'success');
                    // 这里可以添加刷新逻辑
                    // 模拟刷新效果
                    const roomGrid = document.querySelector('.room-grid');
                    if (roomGrid) {
                        roomGrid.style.opacity = '0.5';
                        setTimeout(() => {
                            roomGrid.style.opacity = '1';
                        }, 500);
                    }
                });
            }
            
            // 预订会议室按钮点击事件
            document.querySelector('.btn-primary').addEventListener('click', function() {
                window.location.href = 'meeting_initiate.html';
            });
            
            // 预订会议室按钮点击事件
            const bookButton = document.querySelector('.header-actions .btn-primary');
            if (bookButton) {
                bookButton.addEventListener('click', function() {
                    window.location.href = 'meeting_initiate.html';
                });
            }
            
            // 搜索按钮点击事件
            const searchButton = document.querySelector('.filter-actions .btn-primary');
            if (searchButton) {
                searchButton.addEventListener('click', function() {
                    const roomStatus = document.getElementById('room-status').value;
                    const roomCapacity = document.getElementById('room-capacity').value;
                    const roomEquipment = document.getElementById('room-equipment').value;
                    const roomSearch = document.getElementById('room-search').value.trim();
                    
                    let searchParams = [];
                    if (roomStatus) searchParams.push(`状态：${getOptionText('room-status', roomStatus)}`);
                    if (roomCapacity) searchParams.push(`容纳人数：${getOptionText('room-capacity', roomCapacity)}`);
                    if (roomEquipment) searchParams.push(`设备：${getOptionText('room-equipment', roomEquipment)}`);
                    if (roomSearch) searchParams.push(`搜索：${roomSearch}`);
                    
                    if (searchParams.length > 0) {
                        showMessage(`搜索条件：${searchParams.join('，')}`, 'info');
                        
                        // 模拟搜索逻辑
                        const roomCards = document.querySelectorAll('.room-card');
                        roomCards.forEach(card => {
                            card.style.opacity = '0.3';
                        });
                        
                        setTimeout(() => {
                            roomCards.forEach(card => {
                                card.style.opacity = '1';
                            });
                        }, 500);
                    } else {
                        showMessage('请选择搜索条件', 'warning');
                    }
                });
            }
            
            // 重置按钮点击事件
            const resetButton = document.querySelector('.filter-actions .btn-secondary');
            if (resetButton) {
                resetButton.addEventListener('click', function() {
                    document.getElementById('room-status').value = '';
                    document.getElementById('room-capacity').value = '';
                    document.getElementById('room-equipment').value = '';
                    document.getElementById('room-search').value = '';
                    showMessage('已重置搜索条件', 'success');
                });
            }
            
            // 会议室卡片中的立即预订按钮点击事件
            const bookButtons = document.querySelectorAll('.room-action-btn.primary:not(:disabled)');
            bookButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const roomCard = this.closest('.room-card');
                    const roomName = roomCard.querySelector('.room-name').textContent;
                    window.location.href = `meeting_initiate.html?room=${encodeURIComponent(roomName)}`;
                });
            });
            
            // 会议室卡片中的查看详情按钮点击事件
            const modalOverlay = document.getElementById('room-detail-modal');
            const closeModalBtn = document.getElementById('close-modal');
            const modalCloseBtn = document.getElementById('modal-close-btn');
            const modalBookBtn = document.getElementById('modal-book-btn');
            
            // 获取所有查看详情按钮
            const detailButtons = document.querySelectorAll('.room-action-btn:not(.primary):not([disabled])');
            const detailBtnText = Array.from(detailButtons).findIndex(btn => btn.textContent.trim() === '查看详情');
            
            // 过滤出所有的查看详情按钮
            const filteredDetailButtons = Array.from(detailButtons).filter(btn => btn.textContent.trim() === '查看详情');
            
            // 显示详情模态框函数
            function showDetailModal() {
                modalOverlay.classList.add('show');
            }
            
            // 关闭详情模态框函数
            function closeDetailModal() {
                modalOverlay.classList.remove('show');
            }
            
            filteredDetailButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const roomCard = this.closest('.room-card');
                    const roomName = roomCard.querySelector('.room-name').textContent;
                    const roomStatus = roomCard.querySelector('.room-status').textContent;
                    const roomInfoItems = roomCard.querySelectorAll('.info-item');
                    
                    // 填充模态框数据
                    document.getElementById('detail-room-name').textContent = roomName;
                    document.getElementById('detail-room-status').textContent = roomStatus;
                    
                    // 根据不同会议室设置不同的描述
                    const roomDescriptions = {
                        '会议室A': '标准中型会议室，配备先进的视频会议系统，适合团队会议、客户沟通等场景。',
                        '会议室B': '大型会议室，空间宽敞，设备齐全，适合重要会议、培训等多人参与的活动。',
                        '会议室C': '小型会议室，环境安静，适合小型团队讨论、项目评审等。',
                        '会议室D': '多功能大型会议室，配备专业音响系统，可举办大型会议、演讲活动。',
                        '会议室E': '小型讨论室，环境私密，适合小组讨论、头脑风暴等。',
                        '会议室F': '中型会议室，设备完善，适合部门会议、项目汇报等。'
                    };
                    
                    document.getElementById('detail-room-description').textContent = roomDescriptions[roomName] || '该会议室暂无详细描述。';
                    
                    // 提取并填充会议室信息
                    roomInfoItems.forEach(item => {
                        const label = item.querySelector('.info-label').textContent;
                        const value = item.querySelector('span:last-child').textContent;
                        
                        if (label.includes('容纳')) {
                            document.getElementById('detail-room-capacity').textContent = value;
                        } else if (label.includes('位置')) {
                            document.getElementById('detail-room-location').textContent = value;
                        } else if (label.includes('设备')) {
                            const equipmentList = document.getElementById('detail-equipment-list');
                            equipmentList.innerHTML = '';
                            
                            // 将设备列表转换为标签
                            const equipmentItems = value.split('、');
                            equipmentItems.forEach(equipment => {
                                // 确保不会添加空设备项
                                if (equipment.trim()) {
                                    const tag = document.createElement('span');
                                    tag.className = 'equipment-tag';
                                    tag.textContent = equipment;
                                    equipmentList.appendChild(tag);
                                }
                            });
                        } else if (label.includes('面积')) {
                            document.getElementById('detail-room-area').textContent = value;
                        }
                    });
                    
                    // 根据会议室状态设置预订按钮状态
                    if (roomStatus === '空闲') {
                        modalBookBtn.disabled = false;
                        modalBookBtn.textContent = '立即预订';
                    } else {
                        modalBookBtn.disabled = true;
                        modalBookBtn.textContent = roomStatus === '占用中' ? '已被占用' : '维护中';
                    }
                    
                    // 保存当前会议室名称到预订按钮的dataset
                    modalBookBtn.dataset.roomName = roomName;
                    
                    // 显示模态框
                    showDetailModal();
                });
            });
            
            // 绑定关闭模态框事件
            closeModalBtn.addEventListener('click', closeDetailModal);
            modalCloseBtn.addEventListener('click', closeDetailModal);
            
            // 点击模态框外部关闭模态框
            modalOverlay.addEventListener('click', function(e) {
                if (e.target === modalOverlay) {
                    closeDetailModal();
                }
            });
            
            // 立即预订按钮点击事件
            modalBookBtn.addEventListener('click', function() {
                if (!this.disabled) {
                    const roomName = this.dataset.roomName;
                    window.location.href = `meeting_initiate.html?room=${encodeURIComponent(roomName)}`;
                    closeDetailModal();
                }
            });
            
            // 日程详情模态框相关元素
            const scheduleModal = document.getElementById('room-schedule-modal');
            const scheduleModalTitle = document.getElementById('schedule-modal-title');
            const closeScheduleModalBtn = document.getElementById('close-schedule-modal');
            const scheduleModalCloseBtn = document.getElementById('schedule-modal-close-btn');
            const scheduleModalBookBtn = document.getElementById('schedule-modal-book-btn');
            const scheduleContent = document.getElementById('schedule-content');
            const currentDateRange = document.getElementById('current-date-range');
            
            // 日历导航按钮
            const prevWeekBtn = document.getElementById('prev-week');
            const todayBtn = document.getElementById('today-btn');
            const nextWeekBtn = document.getElementById('next-week');
            
            // 当前选中的会议室名称
            let currentRoomName = '';
            // 当前显示的日期范围
            let currentDateStart = new Date();
            let currentDateEnd = new Date();
            
            // 会议室日程数据 - 模拟数据
            const meetingRoomSchedules = {
                '会议室A': {
                    '2023-06-01': [
                        { time: '10:00 - 11:30', title: '产品需求讨论', organizer: '张三', participants: '5人', status: 'scheduled' }
                    ],
                    '2023-06-02': [
                        { time: '09:00 - 10:00', title: '周例会', organizer: '李四', participants: '8人', status: 'scheduled' },
                        { time: '15:00 - 16:30', title: '客户视频会议', organizer: '王五', participants: '12人', status: 'scheduled' }
                    ],
                    '2023-06-05': [
                        { time: '13:30 - 15:00', title: '技术评审', organizer: '赵六', participants: '6人', status: 'scheduled' }
                    ]
                },
                '会议室B': {
                    '2023-06-01': [
                        { time: '10:00 - 11:30', title: '周例会', organizer: '张三', participants: '12人', status: 'scheduled' },
                        { time: '14:00 - 15:30', title: '客户需求沟通会', organizer: '李四', participants: '10人', status: 'scheduled' }
                    ],
                    '2023-06-02': [
                        { time: '09:30 - 11:30', title: '项目启动会', organizer: '王五', participants: '15人', status: 'scheduled' }
                    ],
                    '2023-06-03': [
                        { time: '14:00 - 17:00', title: '季度总结会', organizer: '赵六', participants: '20人', status: 'scheduled' }
                    ]
                },
                '会议室C': {
                    '2023-06-01': [
                        { time: '16:00 - 17:00', title: '技术讨论', organizer: '张三', participants: '6人', status: 'scheduled' }
                    ],
                    '2023-06-04': [
                        { time: '10:30 - 12:00', title: '产品评审', organizer: '李四', participants: '5人', status: 'scheduled' }
                    ]
                },
                '会议室D': {
                    '2023-06-01': [],
                    '2023-06-02': [],
                    '2023-06-03': [],
                    '2023-06-04': [],
                    '2023-06-05': [],
                    '2023-06-06': [],
                    '2023-06-07': []
                },
                '会议室E': {
                    '2023-06-01': [
                        { time: '16:00 - 17:00', title: '技术讨论', organizer: '王五', participants: '4人', status: 'scheduled' }
                    ],
                    '2023-06-03': [
                        { time: '14:00 - 15:00', title: '团队建设讨论', organizer: '赵六', participants: '5人', status: 'scheduled' }
                    ]
                },
                '会议室F': {
                    '2023-06-01': [
                        { time: '09:30 - 11:00', title: '产品评审会', organizer: '张三', participants: '10人', status: 'scheduled' },
                        { time: '13:30 - 15:30', title: '项目启动会', organizer: '李四', participants: '12人', status: 'scheduled' },
                        { time: '16:00 - 17:30', title: '技术评审', organizer: '王五', participants: '8人', status: 'scheduled' }
                    ],
                    '2023-06-02': [
                        { time: '10:00 - 12:00', title: '客户演示', organizer: '赵六', participants: '15人', status: 'scheduled' }
                    ]
                }
            };
            
            // 初始化日期范围（本周）
            function initializeDateRange() {
                const today = new Date();
                const dayOfWeek = today.getDay() || 7; // 转换为1-7，1是周一，7是周日
                
                // 设置为本周的周一和周日
                currentDateStart = new Date(today);
                currentDateStart.setDate(today.getDate() - (dayOfWeek - 1));
                
                currentDateEnd = new Date(currentDateStart);
                currentDateEnd.setDate(currentDateStart.getDate() + 6);
                
                updateDateRangeDisplay();
            }
            
            // 更新日期范围显示
            function updateDateRangeDisplay() {
                const startYear = currentDateStart.getFullYear();
                const startMonth = currentDateStart.getMonth() + 1;
                const startDate = currentDateStart.getDate();
                
                const endYear = currentDateEnd.getFullYear();
                const endMonth = currentDateEnd.getMonth() + 1;
                const endDate = currentDateEnd.getDate();
                
                currentDateRange.textContent = `${startYear}年${startMonth}月${startDate}日 - ${endYear}年${endMonth}月${endDate}日`;
            }
            
            // 生成日期范围内的所有日期字符串
            function generateDateStrings() {
                const dateStrings = [];
                const current = new Date(currentDateStart);
                
                while (current <= currentDateEnd) {
                    const year = current.getFullYear();
                    const month = String(current.getMonth() + 1).padStart(2, '0');
                    const day = String(current.getDate()).padStart(2, '0');
                    dateStrings.push(`${year}-${month}-${day}`);
                    current.setDate(current.getDate() + 1);
                }
                
                return dateStrings;
            }
            
            // 显示会议室日程
            function showRoomSchedule() {
                if (!currentRoomName) return;
                
                const dateStrings = generateDateStrings();
                const schedules = meetingRoomSchedules[currentRoomName] || {};
                
                // 清空日程内容
                scheduleContent.innerHTML = '';
                
                // 按日期显示日程
                dateStrings.forEach(dateString => {
                    const dateSchedules = schedules[dateString] || [];
                    const dateObj = new Date(dateString);
                    const dayName = ['日', '一', '二', '三', '四', '五', '六'][dateObj.getDay()];
                    const isToday = isSameDay(dateObj, new Date());
                    
                    // 创建日期标题
                    const dayTitle = document.createElement('div');
                    dayTitle.className = 'schedule-day-title';
                    dayTitle.textContent = `${dateObj.getMonth() + 1}月${dateObj.getDate()}日 星期${dayName}${isToday ? ' (今天)' : ''}`;
                    scheduleContent.appendChild(dayTitle);
                    
                    // 如果当天没有日程
                    if (dateSchedules.length === 0) {
                        const emptySchedule = document.createElement('div');
                        emptySchedule.className = 'schedule-empty';
                        emptySchedule.textContent = '当天暂无日程安排';
                        scheduleContent.appendChild(emptySchedule);
                    } else {
                        // 显示当天的所有日程
                        dateSchedules.forEach(schedule => {
                            const scheduleItem = document.createElement('div');
                            scheduleItem.className = 'schedule-detail-item';
                            
                            scheduleItem.innerHTML = `
                                <div class="schedule-time-info">
                                    ${schedule.time}
                                </div>
                                <div class="schedule-content">
                                    <h4>${schedule.title}</h4>
                                    <div class="schedule-meta">
                                        <span>发起人：${schedule.organizer}</span>
                                        <span>参与人数：${schedule.participants}</span>
                                    </div>
                                </div>
                            `;
                            
                            scheduleContent.appendChild(scheduleItem);
                        });
                    }
                });
            }
            
            // 检查两个日期是否是同一天
            function isSameDay(date1, date2) {
                return date1.getFullYear() === date2.getFullYear() &&
                       date1.getMonth() === date2.getMonth() &&
                       date1.getDate() === date2.getDate();
            }
            
            // 切换到上一周
            function goToPrevWeek() {
                currentDateStart.setDate(currentDateStart.getDate() - 7);
                currentDateEnd.setDate(currentDateEnd.getDate() - 7);
                updateDateRangeDisplay();
                showRoomSchedule();
            }
            
            // 切换到下一周
            function goToNextWeek() {
                currentDateStart.setDate(currentDateStart.getDate() + 7);
                currentDateEnd.setDate(currentDateEnd.getDate() + 7);
                updateDateRangeDisplay();
                showRoomSchedule();
            }
            
            // 回到今天所在的周
            function goToToday() {
                initializeDateRange();
                showRoomSchedule();
            }
            
            // 显示日程模态框
            function showScheduleModal(roomName) {
                currentRoomName = roomName;
                scheduleModalTitle.textContent = `${roomName}日程`;
                
                // 从会议室卡片中获取今日日程信息
                // 使用原生JavaScript查找包含指定会议室名称的卡片
                const roomCards = document.querySelectorAll('.room-card');
                let roomCard = null;
                
                for (let i = 0; i < roomCards.length; i++) {
                    const nameElement = roomCards[i].querySelector('.room-name');
                    if (nameElement && nameElement.textContent === roomName) {
                        roomCard = roomCards[i];
                        break;
                    }
                }
                
                // 如果找到对应卡片，则更新日程数据
                if (roomCard) {
                    updateScheduleDataFromCard(roomCard, roomName);
                }
                
                showRoomSchedule();
                scheduleModal.classList.add('show');
                
                // 保存当前会议室名称到预订按钮的dataset
                scheduleModalBookBtn.dataset.roomName = roomName;
            }
            
            // 从会议室卡片更新日程数据
                        function updateScheduleDataFromCard(roomCard, roomName) {
                            // 获取今日日期字符串
                            const today = new Date();
                            const year = today.getFullYear();
                            const month = String(today.getMonth() + 1).padStart(2, '0');
                            const day = String(today.getDate()).padStart(2, '0');
                            const todayString = `${year}-${month}-${day}`;
                            
                            // 初始化会议室的日程数据
                            if (!meetingRoomSchedules[roomName]) {
                                meetingRoomSchedules[roomName] = {};
                            }
                            
                            // 获取卡片上的今日日程
                            const roomSchedule = roomCard.querySelector('.room-schedule');
                            if (roomSchedule) {
                                const scheduleItems = roomSchedule.querySelectorAll('.schedule-item');
                                
                                // 如果有日程项
                                if (scheduleItems.length > 0) {
                                    const todaySchedules = [];
                                    
                                    scheduleItems.forEach(item => {
                                        const time = item.querySelector('.schedule-time').textContent;
                                        const title = item.querySelector('.schedule-item-title').textContent;
                                        
                                        // 添加日程信息（这里使用默认的发起人和参与人数）
                                        todaySchedules.push({
                                            time: time,
                                            title: title,
                                            organizer: '系统',
                                            participants: '未知',
                                            status: 'scheduled'
                                        });
                                    });
                                    
                                    // 更新今日日程数据
                                    meetingRoomSchedules[roomName][todayString] = todaySchedules;
                                } else {
                                    // 如果没有日程项，确保今日日程为空数组
                                    meetingRoomSchedules[roomName][todayString] = [];
                                }
                            }
                        }
            
            // 关闭日程模态框
            function closeScheduleModal() {
                scheduleModal.classList.remove('show');
            }
            
            // 获取流程操作模态框相关元素
            const processModal = document.getElementById('process-action-modal');
            const processModalTitle = document.getElementById('process-modal-title');
            const roomNameInput = document.getElementById('process-room-name');
            const processTypeInput = document.getElementById('process-type');
            const preMeetingForm = document.getElementById('pre-meeting-form');
            const inMeetingForm = document.getElementById('in-meeting-form');
            const postMeetingForm = document.getElementById('post-meeting-form');
            const processActionForm = document.getElementById('process-action-form');
            
            // 显示流程操作模态框
            function showProcessModal(roomName, processType) {
                // 设置模态框标题
                let modalTitle = '';
                switch(processType) {
                    case 'pre-meeting':
                        modalTitle = `${roomName} - 会前准备`;
                        break;
                    case 'in-meeting':
                        modalTitle = `${roomName} - 会中确认`;
                        break;
                    case 'post-meeting':
                        modalTitle = `${roomName} - 会后处理`;
                        break;
                }
                processModalTitle.textContent = modalTitle;
                
                // 设置隐藏字段值
                roomNameInput.value = roomName;
                processTypeInput.value = processType;
                
                // 显示对应的表单内容，隐藏其他表单
                preMeetingForm.classList.remove('active');
                inMeetingForm.classList.remove('active');
                postMeetingForm.classList.remove('active');
                
                switch(processType) {
                    case 'pre-meeting':
                        preMeetingForm.classList.add('active');
                        break;
                    case 'in-meeting':
                        inMeetingForm.classList.add('active');
                        // 初始化签到功能
                        initAttendanceFunctionality();
                        break;
                    case 'post-meeting':
                        postMeetingForm.classList.add('active');
                        // 初始化任务管理功能
                        initTaskManagement();
                        break;
                }
                
                // 显示模态框
                processModal.classList.add('show');
            }
            
            // 初始化任务管理功能
            function initTaskManagement() {
                // 获取添加任务按钮并绑定事件
                const addTaskBtn = document.getElementById('add-task-btn');
                if (addTaskBtn) {
                    addTaskBtn.onclick = addTask;
                }
                
                // 绑定已有的任务移除按钮
                document.querySelectorAll('.remove-task-btn').forEach(btn => {
                    btn.onclick = function() {
                        removeTask(this);
                    };
                });
            }
            
            // 添加任务
            function addTask() {
                const container = document.getElementById('tasks-container');
                
                // 创建新的任务项
                const newTask = document.createElement('div');
                newTask.className = 'task-item';
                newTask.innerHTML = `
                    <input type="text" class="task-description form-control small" placeholder="任务描述">
                    <input type="text" class="task-assignee form-control small" placeholder="负责人">
                    <input type="date" class="task-deadline form-control small">
                    <button type="button" class="remove-task-btn btn-danger small">移除</button>
                `;
                
                // 绑定新添加项的事件
                const removeBtn = newTask.querySelector('.remove-task-btn');
                removeBtn.onclick = function() {
                    removeTask(this);
                };
                
                // 添加到容器
                container.appendChild(newTask);
            }
            
            // 移除任务
            function removeTask(btn) {
                const taskItem = btn.closest('.task-item');
                taskItem.remove();
            }
            
            // 初始化签到功能
            function initAttendanceFunctionality() {
                // 获取添加人员按钮并绑定事件
                const addAttendeeBtn = document.getElementById('add-attendee-btn');
                if (addAttendeeBtn) {
                    addAttendeeBtn.onclick = addAttendee;
                }
                
                // 绑定已有的参会人员移除按钮
                document.querySelectorAll('.remove-attendee-btn').forEach(btn => {
                    btn.onclick = function() {
                        removeAttendee(this);
                    };
                });
                
                // 绑定状态变更事件
                document.querySelectorAll('.attendee-status').forEach(select => {
                    select.onchange = updateAttendanceSummary;
                });
                
                // 初始化签到统计
                updateAttendanceSummary();
            }
            
            // 添加参会人员
            function addAttendee() {
                const container = document.getElementById('attendees-container');
                
                // 创建新的参会人员项
                const newAttendee = document.createElement('div');
                newAttendee.className = 'attendee-item';
                newAttendee.innerHTML = `
                    <input type="text" class="attendee-name form-control small" placeholder="输入姓名">
                    <select class="attendee-status form-control small">
                        <option value="pending">待签到</option>
                        <option value="present">已签到</option>
                        <option value="absent">缺席</option>
                    </select>
                    <input type="time" class="attendee-time form-control small">
                    <button type="button" class="remove-attendee-btn btn-danger small">移除</button>
                `;
                
                // 绑定新添加项的事件
                const removeBtn = newAttendee.querySelector('.remove-attendee-btn');
                removeBtn.onclick = function() {
                    removeAttendee(this);
                };
                
                const statusSelect = newAttendee.querySelector('.attendee-status');
                statusSelect.onchange = function() {
                    updateAttendanceSummary();
                    // 如果设置为已签到，自动填写当前时间
                    if (this.value === 'present') {
                        const timeInput = newAttendee.querySelector('.attendee-time');
                        if (!timeInput.value) {
                            const now = new Date();
                            const hours = String(now.getHours()).padStart(2, '0');
                            const minutes = String(now.getMinutes()).padStart(2, '0');
                            timeInput.value = `${hours}:${minutes}`;
                        }
                    }
                };
                
                // 添加到容器
                container.appendChild(newAttendee);
                
                // 更新签到统计
                updateAttendanceSummary();
            }
            
            // 移除参会人员
            function removeAttendee(btn) {
                const attendeeItem = btn.closest('.attendee-item');
                attendeeItem.remove();
                
                // 更新签到统计
                updateAttendanceSummary();
            }
            
            // 更新签到统计
            function updateAttendanceSummary() {
                const statusSelects = document.querySelectorAll('.attendee-status');
                let presentCount = 0;
                let absentCount = 0;
                let pendingCount = 0;
                
                statusSelects.forEach(select => {
                    switch(select.value) {
                        case 'present':
                            presentCount++;
                            break;
                        case 'absent':
                            absentCount++;
                            break;
                        case 'pending':
                            pendingCount++;
                            break;
                    }
                });
                
                // 更新显示
                document.getElementById('present-count').textContent = presentCount;
                document.getElementById('absent-count').textContent = absentCount;
                document.getElementById('pending-count').textContent = pendingCount;
            }
            
            // 关闭流程操作模态框
            function closeProcessModal() {
                processModal.classList.remove('show');
                // 重置表单
                processActionForm.reset();
            }
            
            // 提交流程操作表单
            function submitProcessForm() {
                const roomName = roomNameInput.value;
                const processType = processTypeInput.value;
                
                // 根据不同的流程类型获取表单数据
                let formData = { roomName, processType };
                
                switch(processType) {
                    case 'pre-meeting':
                        formData.meetingTitle = document.getElementById('meeting-title').value;
                        formData.attendees = document.getElementById('meeting-attendees').value;
                        formData.equipment = Array.from(document.querySelectorAll('input[name="equipment"]:checked')).map(cb => cb.value);
                        formData.notes = document.getElementById('pre-meeting-notes').value;
                        formData.checklist = {
                            equipmentCheck: document.getElementById('equipment-check').checked,
                            cleanCheck: document.getElementById('clean-check').checked,
                            suppliesCheck: document.getElementById('supplies-check').checked
                        };
                        break;
                    
                    case 'in-meeting':
                        formData.currentAgenda = document.getElementById('current-agenda').value;
                        formData.meetingStatus = document.getElementById('meeting-status').value;
                        formData.equipmentStatus = document.getElementById('equipment-status').value;
                        formData.notes = document.getElementById('in-meeting-notes').value;
                        
                        // 收集签到数据
                        const attendeeItems = document.querySelectorAll('.attendee-item');
                        const attendanceData = [];
                        
                        attendeeItems.forEach(item => {
                            const name = item.querySelector('.attendee-name').value;
                            const status = item.querySelector('.attendee-status').value;
                            const time = item.querySelector('.attendee-time').value;
                            
                            attendanceData.push({
                                name: name,
                                status: status,
                                time: time
                            });
                        });
                        
                        formData.attendance = attendanceData;
                        break;
                    
                    case 'post-meeting':
                        // 会议基本信息
                        formData.duration = document.getElementById('meeting-duration').value;
                        formData.actualAttendees = document.getElementById('actual-attendees').value;
                        formData.meetingQuality = document.getElementById('meeting-quality').value;
                        
                        // 会议成果
                        formData.summary = document.getElementById('meeting-summary').value;
                        formData.decisions = document.getElementById('meeting-decisions').value;
                        
                        // 收集任务数据
                        const taskItems = document.querySelectorAll('.task-item');
                        const tasksData = [];
                        
                        taskItems.forEach(item => {
                            const description = item.querySelector('.task-description').value;
                            const assignee = item.querySelector('.task-assignee').value;
                            const deadline = item.querySelector('.task-deadline').value;
                            
                            tasksData.push({
                                description: description,
                                assignee: assignee,
                                deadline: deadline
                            });
                        });
                        
                        formData.tasks = tasksData;
                        
                        // 设备与环境检查
                        formData.checklist = {
                            equipmentOff: document.getElementById('equipment-off').checked,
                            roomCleaned: document.getElementById('room-cleaned').checked,
                            suppliesReturned: document.getElementById('supplies-returned').checked,
                            trashDisposed: document.getElementById('trash-disposed').checked
                        };
                        formData.equipmentIssues = document.getElementById('equipment-issues').value;
                        formData.roomFeedback = document.getElementById('room-feedback').value;
                        
                        // 其他信息
                        formData.improvementSuggestions = document.getElementById('improvement-suggestions').value;
                        formData.notes = document.getElementById('post-meeting-notes').value;
                        break;
                }
                
                // 这里可以添加表单验证逻辑
                let isValid = true;
                let errorMessage = '';
                
                if (processType === 'pre-meeting') {
                    if (!formData.meetingTitle) {
                        isValid = false;
                        errorMessage = '请输入会议标题';
                    } else if (!formData.attendees) {
                        isValid = false;
                        errorMessage = '请输入参会人数';
                    }
                } else if (processType === 'in-meeting') {
                    // 会中表单验证：检查是否有签到数据
                    if (formData.attendance && formData.attendance.length > 0) {
                        let hasValidAttendance = false;
                        for (let i = 0; i < formData.attendance.length; i++) {
                            if (formData.attendance[i].name && formData.attendance[i].status !== 'pending') {
                                hasValidAttendance = true;
                                break;
                            }
                        }
                        
                        if (!hasValidAttendance) {
                            isValid = false;
                            errorMessage = '请添加参会人员并完成签到';
                        }
                    } else {
                        isValid = false;
                        errorMessage = '请添加参会人员';
                    }
                } else if (processType === 'post-meeting') {
                    // 会后表单验证
                    if (!formData.duration) {
                        isValid = false;
                        errorMessage = '请输入实际会议时长';
                    } else if (!formData.summary) {
                        isValid = false;
                        errorMessage = '请输入会议总结';
                    } else if (!formData.checklist.equipmentOff || 
                              !formData.checklist.roomCleaned || 
                              !formData.checklist.suppliesReturned || 
                              !formData.checklist.trashDisposed) {
                        isValid = false;
                        errorMessage = '请完成所有清理检查项';
                    }
                }
                
                if (!isValid) {
                    showMessage(errorMessage, 'error');
                    return;
                }
                
                // 打印表单数据（实际应用中应该发送到服务器）
                console.log('提交的流程表单数据：', formData);
                
                // 显示成功消息
                let successMessage = '';
                switch(processType) {
                    case 'pre-meeting':
                        successMessage = `${roomName} 会前准备完成`;
                        break;
                    case 'in-meeting':
                        // 计算签到统计用于成功消息
                        const presentCount = formData.attendance.filter(a => a.status === 'present').length;
                        successMessage = `${roomName} 会议状态已更新，${presentCount}人已完成签到`;
                        break;
                    case 'post-meeting':
                        // 计算任务数量用于成功消息
                        const taskCount = formData.tasks.filter(t => t.description && t.assignee).length;
                        successMessage = `${roomName} 会后处理完成，共记录 ${taskCount} 项任务`;
                        break;
                }
                
                showMessage(successMessage, 'success');
                
                // 关闭模态框
                closeProcessModal();
            }
            
            // 会议室流程按钮点击事件
            document.querySelectorAll('.process-action-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const roomName = this.dataset.room;
                    const processType = this.dataset.type;
                    showProcessModal(roomName, processType);
                });
            });
            
            // 绑定流程模态框事件
            document.getElementById('close-process-modal').addEventListener('click', closeProcessModal);
            document.getElementById('process-modal-cancel-btn').addEventListener('click', closeProcessModal);
            document.getElementById('process-modal-submit-btn').addEventListener('click', submitProcessForm);
            
            // 点击模态框外部关闭模态框
            processModal.addEventListener('click', function(e) {
                if (e.target === processModal) {
                    closeProcessModal();
                }
            });
            
            // 会议室卡片中的查看日程按钮点击事件
            // 获取所有查看日程按钮
            const allRoomButtons = document.querySelectorAll('.room-action-btn');
            const scheduleButtons = Array.from(allRoomButtons).filter(btn => btn.textContent.trim() === '查看日程');
            
            scheduleButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const roomCard = this.closest('.room-card');
                    const roomName = roomCard.querySelector('.room-name').textContent;
                    showScheduleModal(roomName);
                });
            });
            
            // 绑定日程模态框事件
            closeScheduleModalBtn.addEventListener('click', closeScheduleModal);
            scheduleModalCloseBtn.addEventListener('click', closeScheduleModal);
            
            // 点击模态框外部关闭模态框
            scheduleModal.addEventListener('click', function(e) {
                if (e.target === scheduleModal) {
                    closeScheduleModal();
                }
            });
            
            // 日程模态框预订按钮点击事件
            scheduleModalBookBtn.addEventListener('click', function() {
                const roomName = this.dataset.roomName;
                window.location.href = `meeting_initiate.html?room=${encodeURIComponent(roomName)}`;
            });
            
            // 绑定日历导航按钮事件
            prevWeekBtn.addEventListener('click', goToPrevWeek);
            todayBtn.addEventListener('click', goToToday);
            nextWeekBtn.addEventListener('click', goToNextWeek);
            
            // 初始化日期范围
            initializeDateRange();
            
            // 分页按钮点击事件
            const paginationBtns = document.querySelectorAll('.pagination-btn:not(:disabled)');
            paginationBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    if (this.textContent.trim() === '>') {
                        // 下一页
                        const activeBtn = document.querySelector('.pagination-btn.active');
                        const nextBtn = activeBtn.nextElementSibling;
                        
                        if (nextBtn && nextBtn.textContent.trim() !== '>') {
                            // 移除当前活动状态
                            activeBtn.classList.remove('active');
                            // 添加新活动状态
                            nextBtn.classList.add('active');
                            showMessage(`跳转到第${nextBtn.textContent}页`, 'info');
                            
                            // 模拟分页效果
                            const roomGrid = document.querySelector('.room-grid');
                            if (roomGrid) {
                                roomGrid.style.opacity = '0.3';
                                setTimeout(() => {
                                    roomGrid.style.opacity = '1';
                                }, 300);
                            }
                        }
                    } else if (this.textContent.trim() === '<') {
                        // 上一页
                        const activeBtn = document.querySelector('.pagination-btn.active');
                        const prevBtn = activeBtn.previousElementSibling;
                        
                        if (prevBtn && prevBtn.textContent.trim() !== '<') {
                            // 移除当前活动状态
                            activeBtn.classList.remove('active');
                            // 添加新活动状态
                            prevBtn.classList.add('active');
                            showMessage(`跳转到第${prevBtn.textContent}页`, 'info');
                            
                            // 模拟分页效果
                            const roomGrid = document.querySelector('.room-grid');
                            if (roomGrid) {
                                roomGrid.style.opacity = '0.3';
                                setTimeout(() => {
                                    roomGrid.style.opacity = '1';
                                }, 300);
                            }
                        }
                    } else {
                        // 页码按钮
                        document.querySelectorAll('.pagination-btn').forEach(pBtn => {
                            pBtn.classList.remove('active');
                        });
                        this.classList.add('active');
                        showMessage(`跳转到第${this.textContent}页`, 'info');
                        
                        // 模拟分页效果
                        const roomGrid = document.querySelector('.room-grid');
                        if (roomGrid) {
                            roomGrid.style.opacity = '0.3';
                            setTimeout(() => {
                                roomGrid.style.opacity = '1';
                            }, 300);
                        }
                    }
                });
            });
            
            // 每页显示数量改变事件
            const paginationSelect = document.querySelector('.pagination-select');
            if (paginationSelect) {
                paginationSelect.addEventListener('change', function() {
                    showMessage(`每页显示${this.value}个会议室`, 'info');
                    
                    // 模拟改变每页显示数量效果
                    const roomGrid = document.querySelector('.room-grid');
                    if (roomGrid) {
                        roomGrid.style.opacity = '0.3';
                        setTimeout(() => {
                            roomGrid.style.opacity = '1';
                        }, 300);
                    }
                });
            }
            
            // 辅助函数：根据值获取选项文本
            function getOptionText(selectId, value) {
                const select = document.getElementById(selectId);
                const option = select.querySelector(`option[value="${value}"]`);
                return option ? option.textContent : value;
            }
        });
    </script>
</body>
</html>